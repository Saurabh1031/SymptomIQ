/*! For license information please see bugfender.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["@bugfender/sdk"]=t():e["@bugfender/sdk"]=t()}(self,(()=>(()=>{var e={7496:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7431:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(7496),t),o(r(8704),t),o(r(4596),t),o(r(8836),t),o(r(6758),t),o(r(2922),t),o(r(8287),t),o(r(5484),t),o(r(9929),t)},8704:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_LEVELS=t.LogLevel=void 0,function(e){e[e.Debug=0]="Debug",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Trace=3]="Trace",e[e.Info=4]="Info",e[e.Fatal=5]="Fatal"}(r=t.LogLevel||(t.LogLevel={})),t.LOG_LEVELS=[r.Debug,r.Warning,r.Error,r.Trace,r.Info,r.Fatal]},4596:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e){Object.entries(e).forEach((function(t){var r=t[0];void 0===t[1]&&delete e[r]}))}Object.defineProperty(t,"__esModule",{value:!0}),t.validate=t.removeUndefinedProperties=t.prepareOptions=void 0,t.prepareOptions=function(e){return n(e=r({},e)),function(e,t){["build","version"].forEach((function(t){var r=e[t];"string"==typeof r&&""===r.trim()&&delete e[t]}))}(e),e},t.removeUndefinedProperties=n,t.validate=function(e,t){var r=new RegExp(/^http(s)?:\/\//i);Object.entries(t).forEach((function(t){var n=t[0],o=t[1],i=e[n];o.forEach((function(e){if("required"===e){if(void 0===i)throw new Error("Bugfender requires '".concat(n,"' option to initialize."))}else if("string"===e){if(!["string","undefined"].includes(typeof i))throw new Error("'".concat(n,"' option must be a string."))}else if("url"===e){if(void 0!==i&&!r.test(i))throw new Error("'".concat(n,"' option must be a valid URL."))}else if("boolean"===e&&!["boolean","undefined"].includes(typeof i))throw new Error("'".concat(n,"' option must be a boolean."))}))}))}},8836:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintToConsole=void 0;var n=r(9539),o=r(8704),i=function(){function e(e){this.console=e,this.printToConsole=!1}return e.prototype.init=function(e){this.printToConsole=e},e.prototype.error=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).error.apply(e,t)},e.prototype.info=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).info.apply(e,t)},e.prototype.log=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).log.apply(e,t)},e.prototype.debug=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).debug.apply(e,t)},e.prototype.trace=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).trace.apply(e,t)},e.prototype.warn=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).warn.apply(e,t)},e.prototype.printLog=function(e){if(this.printToConsole){var t=["log","warn","error","trace","info","error"][e.level||o.LogLevel.Debug],r=e.tag?"[".concat(e.tag,"] "):"",i=[e.file||"",e.method||"",e.line||""].filter((function(e){return""!==e})).join(":"),s="".concat(r).concat((0,n.format)(e.text)," ").concat(i);this.console[t](s)}},e}();t.PrintToConsole=i},6758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterErrorHandler=void 0;var r=function(){function e(e){this.window=e,this.rejectionsMap=new Map}return e.prototype.init=function(e){var t=this;this.bugfender=e,this.window.addEventListener("error",(function(e){var r=e.message,n=e.lineno,o=e.filename,i=e.error;t.logError(r,o,n,i)})),this.window.addEventListener("unhandledrejection",(function(e){var r=setTimeout((function(){t.logError("Potentially unhandled promise",void 0,void 0,e.reason)}),1);t.rejectionsMap.set(e.promise,r),e.preventDefault()})),this.window.addEventListener("rejectionhandled",(function(e){clearTimeout(t.rejectionsMap.get(e.promise)),t.rejectionsMap.delete(e.promise)}))},e.prototype.logError=function(e,t,r,n){var o;n&&n.stack&&(o=n.stack),"string"==typeof e&&this.bugfender.sendCrash(e,["Error: ".concat(e),"URL: ".concat(null!=t?t:"N/A"),"Line: ".concat(null!=r?r:"N/A"),"Stack: ".concat(null!=o?o:"N/A")].join("\n"))},e}();t.RegisterErrorHandler=r},2922:function(e,t,r){"use strict";var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.formatLogEntryText=t.format=void 0;var o=r(9539),i=r(8287);function s(e){var t=e.slice(1),r=e[0];try{r=(0,i.mapToString)(r)}catch(e){r=(0,o.format)(r)}return t.length>0?o.format.apply(void 0,n([r],t,!1)):r}t.format=s,t.formatLogEntryText=function(e){return"string"==typeof e?e:function(e){return Array.isArray(e)}(e)?s(e):""}},8287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToString=t.mapToNumber=void 0,t.mapToNumber=function(e){var t=Number(e);if(isNaN(t))throw new Error("Can't be casted to number");return t},t.mapToString=function(e){if(["string","symbol","bigint","function"].includes(typeof e)||e instanceof Error)try{return String(e)}catch(t){return JSON.stringify(e)}else try{return JSON.stringify(e)}catch(t){return String(e)}}},9929:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.UserFeedbackOptionsValidator=void 0;var n={title:"Feedback",hint:"Please insert your feedback here and click send",subjectPlaceholder:"Subject…",feedbackPlaceholder:"Your feedback…",submitLabel:"Send",closeLabel:"Close"},o=function(){function e(){}return e.prototype.init=function(e){return r(r({},n),null!=e?e:{})},e}();t.UserFeedbackOptionsValidator=o},5484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8991:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPEN_BROADCAST_CHANNELS=t.BroadcastChannel=void 0,t.clearNodeFolder=function(e){e=(0,i.fillOptionsWithDefaults)(e);var t=(0,o.chooseMethod)(e);return"node"===t.type?t.clearNodeFolder().then((function(){return!0})):n.PROMISE_RESOLVED_FALSE},t.enforceOptions=function(e){a=e};var n=r(6202),o=r(4632),i=r(423),s=new Set;t.OPEN_BROADCAST_CHANNELS=s;var a,c=0,u=function(e,t){var r,u;this.id=c++,s.add(this),this.name=e,a&&(t=a),this.options=(0,i.fillOptionsWithDefaults)(t),this.method=(0,o.chooseMethod)(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,u=(r=this).method.create(r.name,r.options),(0,n.isPromise)(u)?(r._prepP=u,u.then((function(e){r._state=e}))):r._state=u};function l(e,t,r){var o={time:e.method.microSeconds(),type:t,data:r};return(e._prepP?e._prepP:n.PROMISE_RESOLVED_VOID).then((function(){var t=e.method.postMessage(e._state,o);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function d(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function p(e,t,r){e._addEL[t].push(r),function(e){if(!e._iL&&d(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var r=e.time-1e5;t.time>=r&&e.fn(t.data)}))},r=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,r)})):(e._iL=!0,e.method.onMessage(e._state,t,r))}}(e)}function f(e,t,r){e._addEL[t]=e._addEL[t].filter((function(e){return e!==r})),function(e){if(e._iL&&!d(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}t.BroadcastChannel=u,u._pubkey=!0,u.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return l(this,"message",e)},postInternal:function(e){return l(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};f(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,p(this,"message",t)):this._onML=null},addEventListener:function(e,t){p(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){f(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){s.delete(this),this.closed=!0;var t=this._prepP?this._prepP:n.PROMISE_RESOLVED_VOID;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}}},8437:(e,t,r)=>{"use strict";var n=r(5585);e.exports={BroadcastChannel:n.BroadcastChannel,createLeaderElection:n.createLeaderElection,clearNodeFolder:n.clearNodeFolder,enforceOptions:n.enforceOptions,beLeader:n.beLeader}},5585:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BroadcastChannel",{enumerable:!0,get:function(){return n.BroadcastChannel}}),Object.defineProperty(t,"OPEN_BROADCAST_CHANNELS",{enumerable:!0,get:function(){return n.OPEN_BROADCAST_CHANNELS}}),Object.defineProperty(t,"beLeader",{enumerable:!0,get:function(){return o.beLeader}}),Object.defineProperty(t,"clearNodeFolder",{enumerable:!0,get:function(){return n.clearNodeFolder}}),Object.defineProperty(t,"createLeaderElection",{enumerable:!0,get:function(){return o.createLeaderElection}}),Object.defineProperty(t,"enforceOptions",{enumerable:!0,get:function(){return n.enforceOptions}});var n=r(8991),o=r(6550)},6550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beLeader=a,t.createLeaderElection=function(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var r=new i(e,t);return e._befC.push((function(){return r.die()})),e._leaderElector=r,r};var n=r(6202),o=r(4810),i=function(e,t){var r=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this.hasLeader=!1,this.isDead=!1,this.token=(0,n.randomToken)(),this._aplQ=n.PROMISE_RESOLVED_VOID,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var o=function(e){"leader"===e.context&&("death"===e.action&&(r.hasLeader=!1),"tell"===e.action&&(r.hasLeader=!0))};this.broadcastChannel.addEventListener("internal",o),this._lstns.push(o)};function s(e,t){var r={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(r)}function a(e){e.isLeader=!0,e.hasLeader=!0;var t=(0,o.add)((function(){return e.die()}));e._unl.push(t);var r=function(t){"leader"===t.context&&"apply"===t.action&&s(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),s(e,"tell"))};return e.broadcastChannel.addEventListener("internal",r),e._lstns.push(r),s(e,"tell")}i.prototype={applyOnce:function(e){var t=this;return this.isLeader?(0,n.sleep)(0,!0):this.isDead?(0,n.sleep)(0,!1):this._aplQC>1?this._aplQ:(this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return function(){if(t.isLeader)return n.PROMISE_RESOLVED_TRUE;var r,o=!1,i=new Promise((function(e){r=function(){o=!0,e()}})),c=function(e){"leader"===e.context&&e.token!=t.token&&("apply"===e.action&&e.token>t.token&&r(),"tell"===e.action&&(r(),t.hasLeader=!0))};t.broadcastChannel.addEventListener("internal",c);var u=e?4*t._options.responseTime:t._options.responseTime;return s(t,"apply").then((function(){return Promise.race([(0,n.sleep)(u),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return s(t,"apply")})).then((function(){return Promise.race([(0,n.sleep)(u),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",c),!o&&a(t).then((function(){return!0}))}))}()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader})))},awaitLeadership:function(){return this._aLP||(this._aLP=(e=this).isLeader?n.PROMISE_RESOLVED_VOID:new Promise((function(t){var r=!1;function o(){r||(r=!0,e.broadcastChannel.removeEventListener("internal",i),t(!0))}e.applyOnce().then((function(){e.isLeader&&o()})),function t(){return(0,n.sleep)(e._options.fallbackInterval).then((function(){if(!e.isDead&&!r)return e.isLeader?void o():e.applyOnce(!0).then((function(){e.isLeader?o():t()}))}))}();var i=function(t){"leader"===t.context&&"death"===t.action&&(e.hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&o()})))};e.broadcastChannel.addEventListener("internal",i),e._lstns.push(i)}))),this._aLP;var e},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.hasLeader=!1,this.isLeader=!1),this.isDead=!0,s(this,"death")}}},4632:(e,t,r)=>{"use strict";r(8698),Object.defineProperty(t,"__esModule",{value:!0}),t.chooseMethod=function(e){var t=[].concat(e.methods,a).filter(Boolean);if(e.type){if("simulate"===e.type)return s.SimulateMethod;var r=t.find((function(t){return t.type===e.type}));if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var n=t.find((function(e){return e.canBeUsed()}));if(n)return n;throw new Error("No usable method found in "+JSON.stringify(a.map((function(e){return e.type}))))};var n=r(6115),o=r(9122),i=r(4924),s=r(1574),a=[n.NativeMethod,o.IndexedDBMethod,i.LocalstorageMethod]},9122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSACTION_SETTINGS=t.IndexedDBMethod=void 0,t.averageResponseTime=P,t.canBeUsed=O,t.cleanOldMessages=g,t.close=w,t.commitIndexedDBTransaction=l,t.create=v,t.createDatabase=d,t.getAllMessages=function(e){var t=e.transaction(a,"readonly",c),r=t.objectStore(a),n=[];return new Promise((function(e){r.openCursor().onsuccess=function(r){var o=r.target.result;o?(n.push(o.value),o.continue()):(l(t),e(n))}}))},t.getIdb=u,t.getMessagesHigherThan=f,t.getOldMessages=h,t.microSeconds=void 0,t.onMessage=I,t.postMessage=S,t.removeMessagesById=y,t.type=void 0,t.writeMessage=p;var n=r(6202),o=r(2151),i=r(423),s=n.microSeconds;t.microSeconds=s;var a="messages",c={durability:"relaxed"};function u(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function l(e){e.commit&&e.commit()}function d(e){var t="pubkey.broadcast-channel-0-"+e,r=u().open(t);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(a,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}function p(e,t,r){var n={uuid:t,time:(new Date).getTime(),data:r},o=e.transaction([a],"readwrite",c);return new Promise((function(e,t){o.oncomplete=function(){return e()},o.onerror=function(e){return t(e)},o.objectStore(a).add(n),l(o)}))}function f(e,t){var r=e.transaction(a,"readonly",c),n=r.objectStore(a),o=[],i=IDBKeyRange.bound(t+1,1/0);if(n.getAll){var s=n.getAll(i);return new Promise((function(e,t){s.onerror=function(e){return t(e)},s.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,s){var a=function(){try{return i=IDBKeyRange.bound(t+1,1/0),n.openCursor(i)}catch(e){return n.openCursor()}}();a.onerror=function(e){return s(e)},a.onsuccess=function(n){var i=n.target.result;i?i.value.id<t+1?i.continue(t+1):(o.push(i.value),i.continue()):(l(r),e(o))}}))}function y(e,t){if(e.closed)return Promise.resolve([]);var r=e.db.transaction(a,"readwrite",c).objectStore(a);return Promise.all(t.map((function(e){var t=r.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}function h(e,t){var r=(new Date).getTime()-t,n=e.transaction(a,"readonly",c),o=n.objectStore(a),i=[];return new Promise((function(e){o.openCursor().onsuccess=function(t){var o=t.target.result;if(o){var s=o.value;s.time<r?(i.push(s),o.continue()):(l(n),e(i))}else e(i)}}))}function g(e){return h(e.db,e.options.idb.ttl).then((function(t){return y(e,t.map((function(e){return e.id})))}))}function v(e,t){return t=(0,i.fillOptionsWithDefaults)(t),d(e).then((function(r){var i={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:(0,n.randomToken)(),eMIs:new o.ObliviousSet(2*t.idb.ttl),writeBlockPromise:n.PROMISE_RESOLVED_VOID,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){i.closed=!0,t.idb.onclose&&t.idb.onclose()},b(i),i}))}function b(e){e.closed||m(e).then((function(){return(0,n.sleep)(e.options.idb.fallbackInterval)})).then((function(){return b(e)}))}function m(e){return e.closed?n.PROMISE_RESOLVED_VOID:e.messagesCallback?f(e.db,e.lastCursorId).then((function(t){var r=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return r.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),n.PROMISE_RESOLVED_VOID})):n.PROMISE_RESOLVED_VOID}function w(e){e.closed=!0,e.db.close()}function S(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return p(e.db,e.uuid,t)})).then((function(){0===(0,n.randomInt)(0,10)&&g(e)})),e.writeBlockPromise}function I(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,m(e)}function O(){return!!u()}function P(e){return 2*e.idb.fallbackInterval}t.TRANSACTION_SETTINGS=c,t.type="idb";var E={create:v,close:w,onMessage:I,postMessage:S,canBeUsed:O,type:"idb",averageResponseTime:P,microSeconds:s};t.IndexedDBMethod=E},4924:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalstorageMethod=void 0,t.addStorageEventListener=d,t.averageResponseTime=v,t.canBeUsed=g,t.close=y,t.create=f,t.getLocalStorage=c,t.microSeconds=void 0,t.onMessage=h,t.postMessage=l,t.removeStorageEventListener=p,t.storageKey=u,t.type=void 0;var n=r(2151),o=r(423),i=r(6202),s=i.microSeconds;t.microSeconds=s;var a="localstorage";function c(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function u(e){return"pubkey.broadcastChannel-"+e}function l(e,t){return new Promise((function(r){(0,i.sleep)().then((function(){var n=u(e.channelName),o={token:(0,i.randomToken)(),time:(new Date).getTime(),data:t,uuid:e.uuid},s=JSON.stringify(o);c().setItem(n,s);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=n,a.newValue=s,window.dispatchEvent(a),r()}))}))}function d(e,t){var r=u(e),n=function(e){e.key===r&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",n),n}function p(e){window.removeEventListener("storage",e)}function f(e,t){if(t=(0,o.fillOptionsWithDefaults)(t),!g())throw new Error("BroadcastChannel: localstorage cannot be used");var r=(0,i.randomToken)(),s=new n.ObliviousSet(t.localstorage.removeTimeout),a={channelName:e,uuid:r,eMIs:s};return a.listener=d(e,(function(e){a.messagesCallback&&e.uuid!==r&&e.token&&!s.has(e.token)&&(e.data.time&&e.data.time<a.messagesCallbackTime||(s.add(e.token),a.messagesCallback(e.data)))})),a}function y(e){p(e.listener)}function h(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function g(){var e=c();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}function v(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120}t.type=a;var b={create:f,close:y,onMessage:h,postMessage:l,canBeUsed:g,type:a,averageResponseTime:v,microSeconds:s};t.LocalstorageMethod=b},6115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NativeMethod=void 0,t.averageResponseTime=d,t.canBeUsed=l,t.close=a,t.create=s,t.microSeconds=void 0,t.onMessage=u,t.postMessage=c,t.type=void 0;var n=r(6202),o=n.microSeconds;t.microSeconds=o;var i="native";function s(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t}function a(e){e.bc.close(),e.subFns=[]}function c(e,t){try{return e.bc.postMessage(t,!1),n.PROMISE_RESOLVED_VOID}catch(e){return Promise.reject(e)}}function u(e,t){e.messagesCallback=t}function l(){if("undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1}function d(){return 150}t.type=i;var p={create:s,close:a,onMessage:u,postMessage:c,canBeUsed:l,type:i,averageResponseTime:d,microSeconds:o};t.NativeMethod=p},1574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulateMethod=void 0,t.averageResponseTime=d,t.canBeUsed=l,t.close=a,t.create=s,t.microSeconds=void 0,t.onMessage=u,t.postMessage=c,t.type=void 0;var n=r(6202).microSeconds;t.microSeconds=n;var o="simulate";t.type=o;var i=new Set;function s(e){var t={name:e,messagesCallback:null};return i.add(t),t}function a(e){i.delete(e)}function c(e,t){return new Promise((function(r){return setTimeout((function(){Array.from(i).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),r()}),5)}))}function u(e,t){e.messagesCallback=t}function l(){return!0}function d(){return 5}var p={create:s,close:a,onMessage:u,postMessage:c,canBeUsed:l,type:o,averageResponseTime:d,microSeconds:n};t.SimulateMethod=p},423:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillOptionsWithDefaults=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}},6202:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROMISE_RESOLVED_VOID=t.PROMISE_RESOLVED_TRUE=t.PROMISE_RESOLVED_FALSE=void 0,t.isPromise=function(e){return e&&"function"==typeof e.then},t.microSeconds=function(){var e=(new Date).getTime();return e===i?1e3*e+ ++s:(i=e,s=0,1e3*e)},t.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},t.randomToken=function(){return Math.random().toString(36).substring(2)},t.sleep=function(e,t){return e||(e=0),new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))};var r=Promise.resolve(!1);t.PROMISE_RESOLVED_FALSE=r;var n=Promise.resolve(!0);t.PROMISE_RESOLVED_TRUE=n;var o=Promise.resolve();t.PROMISE_RESOLVED_VOID=o;var i=0,s=0},1924:(e,t,r)=>{"use strict";var n=r(210),o=r(5559),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},5559:(e,t,r)=>{"use strict";var n=r(8612),o=r(210),i=o("%Function.prototype.apply%"),s=o("%Function.prototype.call%"),a=o("%Reflect.apply%",!0)||n.call(s,i),c=o("%Object.getOwnPropertyDescriptor%",!0),u=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=a(n,s,arguments);if(c&&u){var r=c(t,"length");r.configurable&&u(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var d=function(){return a(n,i,arguments)};u?u(e.exports,"apply",{value:d}):e.exports.apply=d},9804:e=>{var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(e,n,o){if("[object Function]"!==r.call(n))throw new TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var s=0;s<i;s++)n.call(o,e[s],s,e);else for(var a in e)t.call(e,a)&&n.call(o,e[a],a,e)}},7648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,o="[object Function]";e.exports=function(e){var i=this;if("function"!=typeof i||n.call(i)!==o)throw new TypeError(t+i);for(var s,a=r.call(arguments,1),c=function(){if(this instanceof s){var t=i.apply(this,a.concat(r.call(arguments)));return Object(t)===t?t:this}return i.apply(e,a.concat(r.call(arguments)))},u=Math.max(0,i.length-a.length),l=[],d=0;d<u;d++)l.push("$"+d);if(s=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(c),i.prototype){var p=function(){};p.prototype=i.prototype,s.prototype=new p,p.prototype=null}return s}},8612:(e,t,r)=>{"use strict";var n=r(7648);e.exports=Function.prototype.bind||n},210:(e,t,r)=>{"use strict";var n,o=SyntaxError,i=Function,s=TypeError,a=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var u=function(){throw new s},l=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(e){return u}}}():u,d=r(1405)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},y="undefined"==typeof Uint8Array?n:p(Uint8Array),h={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":l,"%TypedArray%":y,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(r=p(o.prototype))}return h[t]=r,r},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=r(8612),m=r(7642),w=b.call(Function.call,Array.prototype.concat),S=b.call(Function.apply,Array.prototype.splice),I=b.call(Function.call,String.prototype.replace),O=b.call(Function.call,String.prototype.slice),P=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,D=function(e){var t=O(e,0,1),r=O(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return I(e,P,(function(e,t,r,o){n[n.length]=r?I(o,E,"$1"):t||e})),n},j=function(e,t){var r,n=e;if(m(v,n)&&(n="%"+(r=v[n])[0]+"%"),m(h,n)){var i=h[n];if(i===f&&(i=g(n)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');var r=D(e),n=r.length>0?r[0]:"",i=j("%"+n+"%",t),a=i.name,u=i.value,l=!1,d=i.alias;d&&(n=d[0],S(r,w([0,1],d)));for(var p=1,f=!0;p<r.length;p+=1){var y=r[p],g=O(y,0,1),v=O(y,-1);if(('"'===g||"'"===g||"`"===g||'"'===v||"'"===v||"`"===v)&&g!==v)throw new o("property names with quotes must have matching quotes");if("constructor"!==y&&f||(l=!0),m(h,a="%"+(n+="."+y)+"%"))u=h[a];else if(null!=u){if(!(y in u)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&p+1>=r.length){var b=c(u,y);u=(f=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:u[y]}else f=m(u,y),u=u[y];f&&!l&&(h[a]=u)}}return u}},1405:(e,t,r)=>{"use strict";var n=r.g.Symbol,o=r(5419);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&o()}},5419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},9608:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},6410:(e,t,r)=>{"use strict";var n=r(9608);e.exports=function(){return n()&&!!Symbol.toStringTag}},7642:(e,t,r)=>{"use strict";var n=r(8612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},2584:(e,t,r)=>{"use strict";var n=r(6410)(),o=r(1924)("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},s=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=s,e.exports=a?i:s},8662:(e,t,r)=>{"use strict";var n,o=Object.prototype.toString,i=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=r(6410)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(i.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===o.call(e);if(!c)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&c(t)}return c(e)===n}},5692:(e,t,r)=>{"use strict";var n=r(9804),o=r(3083),i=r(1924),s=i("Object.prototype.toString"),a=r(6410)(),c="undefined"==typeof globalThis?r.g:globalThis,u=o(),l=i("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},d=i("String.prototype.slice"),p={},f=r(882),y=Object.getPrototypeOf;a&&f&&y&&n(u,(function(e){var t=new c[e];if(Symbol.toStringTag in t){var r=y(t),n=f(r,Symbol.toStringTag);if(!n){var o=y(r);n=f(o,Symbol.toStringTag)}p[e]=n.get}})),e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=d(s(e),8,-1);return l(u,t)>-1}return!!f&&function(e){var t=!1;return n(p,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},2151:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ObliviousSet:()=>n,now:()=>i,removeTooOldValues:()=>o});var n=function(){function e(e){this.ttl=e,this.map=new Map,this._to=!1}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.add=function(e){var t=this;this.map.set(e,i()),this._to||(this._to=!0,setTimeout((function(){t._to=!1,o(t)}),0))},e.prototype.clear=function(){this.map.clear()},e}();function o(e){for(var t=i()-e.ttl,r=e.map[Symbol.iterator]();;){var n=r.next().value;if(!n)return;var o=n[0];if(!(n[1]<t))return;e.map.delete(o)}}function i(){return(new Date).getTime()}},4155:e=>{var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var a,c=[],u=!1,l=-1;function d(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&p())}function p(){if(!u){var e=s(d);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function y(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=y,n.addListener=y,n.once=y,n.off=y,n.removeListener=y,n.removeAllListeners=y,n.emit=y,n.prependListener=y,n.prependOnceListener=y,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},1562:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiClient=void 0,t.ApiClient=class{constructor(e,t){this.appKey=e,this.http=t}getDeviceStatus(e){const t={app_token:this.appKey,device:e};return this.http.post("/app/device-status",t).then((e=>{const t=void 0!==e.error,r=!t||t&&-1004!==e.error.code;return{isDeviceEnabled:void 0!==e.logger_enabled&&e.logger_enabled,isAppValid:r}}))}sendSession(e){return this.http.post("/session",e)}sendLogs(e,t){return this.http.post("/log/batch",{session_id:e,logs:t})}sendIssue(e,t,r,n,o,i){const s={uid:e,title:r,text:n,app:{key:this.appKey},type:o,session_id:i};return this.http.post("/issue",s).then((()=>({uuid:e,issueURL:t})))}setDeviceKey(e,t,r){return this.http.post("/device/keyvalue",{app_key:this.appKey,device_id:e,key:t,value:r})}}},4319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventPrinter=void 0;const n=r(8593);t.EventPrinter=class{constructor(e,t){this.console=e,this.printToConsole=t,this.styles={bold:"font-weight:bold",icon:"color:#ff5060",italic:"font-style:italic",neutral:"color:#999",regular:"color:#222"}}print(e,t,r,o){if(!this.printToConsole)return;const i=`%c${e}%c ${t}`;o=[this.styles.icon,this.styles.regular,...null!=o?o:[]],r?this.console.info(i,...o,(0,n.getElByXPath)(r)):this.console.info(i,...o)}printDeviceKey(e,t){null===t?this.print("◆",`Device key %c"${e}"%c removed`,void 0,[this.styles.italic,this.styles.bold]):this.print("◆",`Device key %c"${e}" %cset%c to %c"${t}"`,void 0,[this.styles.italic,this.styles.bold,this.styles.regular,this.styles.italic])}printJsEvent(e){const t=JSON.parse(e.text);switch(t.event){case"DOMContentLoaded":this.print("●","DOM content %cloaded",void 0,[this.styles.bold]);break;case"PageLoaded":this.print("●","Page %cloaded",void 0,[this.styles.bold]);break;case"hashchange":this.print("#",`URL %chash changed%c to %c"${t.hash}"`,void 0,[this.styles.bold,this.styles.regular,this.styles.italic]);break;case"blur":case"click":case"focus":case"keyup":{const e="click"===t.event?"⊙":"▭",r=t.text&&"keyup"===t.event?` value=${this.truncate(t.text)}`:"",n={blur:"blurred",click:"clicked",focus:"focused",keyup:"keyup"};this.print(e,`Element %c${n[t.event]}%c${r}%c:`,t.xpath,[this.styles.bold,this.styles.neutral,this.styles.regular]);break}case"submit":this.print("↑","Form %csubmited",t.xpath,[this.styles.bold]);break;case"popstate":case"pushstate":this.print("↦","Navigation %cstate changed",void 0,[this.styles.bold]);break;default:throw new n.UnreachableCaseError(t)}}truncate(e){return e.length>15?`${e.substring(0,15)}… [${e.length}]`:e}}},2329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OverrideConsoleMethods=void 0;const n=r(7431);t.OverrideConsoleMethods=class{constructor(e,t){this.commands=e,this.window=t}init(e){const t=this,r={log:n.LogLevel.Debug,trace:n.LogLevel.Trace,info:n.LogLevel.Info,warn:n.LogLevel.Warning,error:n.LogLevel.Error};this.window.console=function(n){return Object.assign(Object.assign({},n),Object.fromEntries(Object.keys(r).map((o=>[o,function(...i){t.commands.addLogMessage(r[o],i),e||n[o](...i)}]))))}(this.window.console)}}},277:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterBrowserEventsHandler=void 0;const n=r(7725);class o extends n.RegisterEventsHandlerBase{constructor(e,t){super(e,t),this.commands=e,this.window=t}init(){if(!this.window.document.addEventListener)return;const e=!this.supportsPassiveEvents()||{passive:!0,capture:!0};this.window.addEventListener("load",(()=>{this.addJsEventLogEntry({event:"PageLoaded",performance:this.window.performance})}),e),this.window.addEventListener("DOMContentLoaded",(()=>{this.addJsEventLogEntry({event:"DOMContentLoaded"})}),e),this.window.addEventListener("popstate",(e=>{this.addJsEventLogEntry({event:"popstate",location:this.window.location.href,state:JSON.stringify(e.state)})}),e),this.window.addEventListener("hashchange",(()=>{this.addJsEventLogEntry({event:"hashchange",hash:this.window.location.hash})}),e);const t=e=>{const t=this;return function(...r){const n=r.length>2?r[2]:void 0;return n&&t.addJsEventLogEntry({event:"pushstate",to:String(n),state:r.length>1?JSON.stringify(r[1]):null}),e.apply(this,r)}};this.override(this.window.history,"pushState",t),this.override(this.window.history,"replaceState",t)}override(e,t,r){if(!(t in e))return;const n=r(e[t]);e[t]=n}}t.RegisterBrowserEventsHandler=o},7725:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterEventsHandlerBase=void 0,t.RegisterEventsHandlerBase=class{constructor(e,t){this.commands=e,this.window=t}addJsEventLogEntry(e){const t={tag:"js_event",text:JSON.stringify(e),url:this.getURL()};this.commands.addLogEntry(t)}getURL(){return this.window?this.window.location.href:""}supportsPassiveEvents(){let e=!1;try{const t=()=>{},r={get passive(){return e=!0,!1}};this.window.addEventListener("offline",t,r),this.window.removeEventListener("offline",t,!1)}catch(t){e=!1}return e}}},5881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterUIEventsHandler=void 0;const n=r(8593),o=r(7725);class i extends o.RegisterEventsHandlerBase{constructor(e,t){super(e,t),this.commands=e,this.window=t}init(){if(!this.window.document.addEventListener)return;const e=!this.supportsPassiveEvents()||{passive:!0,capture:!0};document.addEventListener("click",(e=>{e.target instanceof Element&&this.addJsEventLogEntry(this.getEventData(e.target,"click"))}),e),document.addEventListener("focusin",(e=>{e.target instanceof Element&&this.addJsEventLogEntry(this.getEventData(e.target,"focus"))}),e),document.addEventListener("focusout",(e=>{e.target instanceof Element&&this.addJsEventLogEntry(this.getEventData(e.target,"blur"))}),e),this.window.addEventListener("submit",(e=>{e.target instanceof Element&&this.addJsEventLogEntry(this.getEventData(e.target,"submit"))}),e);const t=new n.DebounceByElement(400),r=["Tab","Meta","MetaLeft","MetaRight","Alt","AltLeft","AltRight","Control","ControlLeft","ControlRight","Shift","ShiftLeft","ShiftRight","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PageDown","PageUp","Home","End","CapsLock"];this.window.addEventListener("keyup",(e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)||!e.composedPath||r.includes(e.code))return;const n=e.target,o=e.composedPath();t.run(n,(()=>{this.sendKeyupLog(n,o)}))}),e)}sendKeyupLog(e,t){var r;const n="password"===(null!==(r=e.getAttribute("type"))&&void 0!==r?r:"").toLowerCase(),o=t.filter((e=>e instanceof HTMLElement)).some((e=>"bfIgnoreKeypress"in e.dataset)),i=n||o;this.addJsEventLogEntry(Object.assign(Object.assign({},this.getEventData(e,"keyup")),{text:i?void 0:e.value}))}getEventData(e,t){const r=e.childElementCount<=1?e.textContent:void 0,o="FORM"===e.tagName?e:null;return{event:t,url:this.window?this.window.location.href:"",xpath:(0,n.getXPath)(e),tag:e.tagName,id:e.id,text:null!=r?r:void 0,action:o&&o.action?o.action:""}}}t.RegisterUIEventsHandler=i},2853:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Bugfender=void 0;const o=r(7431),i=r(2607),s=r(7935),a=r(8593);class c{constructor(e,t,r){this.preInitProvider=e,this.sdkUserAgent=t,this.version=r,this.LogLevel=o.LogLevel,this.initDeferred=(0,a.createDeferred)(),this.commands=this.preInitProvider.provideCommandsQueue()}init(e){return n(this,void 0,void 0,(function*(){const t=this.preInitProvider.provideOperationModes(),r=this.preInitProvider.provideSDKOptionsValidator();if(this.options=r.init(e),this.provider=new s.MainProvider(this.options,this.preInitProvider,this.sdkUserAgent,this.version),this.processor=yield this.provider.getStorageProcessor(),this.options.debug){const e=this.preInitProvider.provideAPIFeatureDetection();this.provider.getLogger(c.name).log("DEBUG",{debug:this.options.debug,operation:{mode:yield t.getMode(),isMultiTab:yield t.isMultiTab(),isMultiThread:yield t.isMultiThread()},features:{broadcastChannel:yield e.isBroadcastChannelSupported(),indexedDB:yield e.isIndexedDBSupported(),localStorage:e.isLocalStorageSupported(),sessionStorage:e.isSessionStorageSupported(),worker:e.isWorkerSupported()}})}const o=yield this.provider.getResetStorage();yield o.resetIfAppChanged(this.options.appID);const i=yield this.provider.getStorageWriterHub();i.init(this.options),this.options.logBrowserEvents&&this.provider.getRegisterBrowserEventsHandler().init(),this.options.logUIEvents&&this.provider.getRegisterUIEventsHandler().init(),this.options.registerErrorHandler&&this.provider.getRegisterErrorHandler().init(this),this.options.overrideConsoleMethods&&this.provider.getOverrideConsoleMethods().init(this.options.printToConsole),this.provider.getPrintToConsole().init(this.options.printToConsole),window.addEventListener("beforeunload",(()=>n(this,void 0,void 0,(function*(){this.processor.run()})))),this.commands.init(i);const a=this.preInitProvider.provideBrowser();this.setDeviceKey("$browser",a.getName()),this.initDeferred.resolve()}))}forceSendOnce(){this.commands.forceSendOnce()}getDeviceURL(){return n(this,void 0,void 0,(function*(){yield this.initDeferred.promise;const e=yield this.provider.getDevice();return`${this.options.baseURL}/intent/${this.options.appID}/device/${e.getUDID()}`}))}getSessionURL(){return n(this,void 0,void 0,(function*(){yield this.initDeferred.promise;const e=yield this.provider.getCurrentSession();return`${this.options.baseURL}/intent/${this.options.appID}/session/${e.getUUID()}`}))}getUserFeedback(e){return n(this,void 0,void 0,(function*(){return this.preInitProvider.provideUserFeedback().show(e)}))}log(...e){this.commands.addLogMessage(o.LogLevel.Debug,[...e])}warn(...e){this.commands.addLogMessage(o.LogLevel.Warning,[...e])}error(...e){this.commands.addLogMessage(o.LogLevel.Error,[...e])}trace(...e){this.commands.addLogMessage(o.LogLevel.Trace,[...e])}info(...e){this.commands.addLogMessage(o.LogLevel.Info,[...e])}fatal(...e){this.commands.addLogMessage(o.LogLevel.Fatal,[...e])}removeDeviceKey(e){this.commands.setDeviceKey(e,null)}sendLog(e){this.commands.addLogEntry(e)}sendIssue(e,t){return n(this,void 0,void 0,(function*(){return this.commands.addIssue(i.IssueType.Issue,e,t)}))}sendCrash(e,t){return n(this,void 0,void 0,(function*(){return this.commands.addIssue(i.IssueType.Crash,e,t)}))}sendUserFeedback(e,t){return n(this,void 0,void 0,(function*(){return this.commands.addIssue(i.IssueType.Feedback,e,t)}))}setDeviceKey(e,t){this.commands.setDeviceKey(e,t)}setForceEnabled(e){this.initDeferred.promise.then((()=>{this.provider.getStorageGuard().setDeviceForceEnabled(e)}))}}t.Bugfender=c},6110:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MonoChannel=t.Channel=t.createBroadcastChannel=t.MessageType=void 0;const o=r(8437);var i;!function(e){e.ForceSend="force-send",e.Ping="ping",e.Pong="pong"}(i=t.MessageType||(t.MessageType={})),t.createBroadcastChannel=function(){return new o.BroadcastChannel("bf-sdk")},t.Channel=class{constructor(e,t){this.channel=e,this.logger=t,this.leader=!1,this.onForceSendCb=()=>{},this.sessionsStatus={},this.channel.onmessage=e=>this.handleMessage(e),this.elector=(0,o.createLeaderElection)(this.channel,{fallbackInterval:2e3,responseTime:1e3}),this.leaderPromise=this.elector.awaitLeadership(),this.leaderPromise.then((()=>{this.logger.log("Now I'm the leader. 💪"),this.leader=!0}))}setCurrentSession(e){this.session=e}handleMessage(e){var t,r;switch(e.type){case i.ForceSend:this.leader&&this.onForceSendCb();break;case i.Ping:e.toSessionUUID===(null===(t=this.session)||void 0===t?void 0:t.getUUID())&&this.channel.postMessage({type:i.Pong,fromSessionUUID:e.toSessionUUID,toSessionUUID:e.fromSessionUUID});break;case i.Pong:e.toSessionUUID===(null===(r=this.session)||void 0===r?void 0:r.getUUID())&&(this.sessionsStatus[e.fromSessionUUID]=!0)}}isLeader(){return this.leader}notifyForceSend(){this.leader?this.onForceSendCb():this.channel.postMessage({type:i.ForceSend})}onForceSend(e){this.onForceSendCb=e}onHasBecomeLeader(){return this.leaderPromise}isSessionActive(e){return n(this,void 0,void 0,(function*(){const t=!!this.session;return!(t&&(!t||this.session.getUUID()!==e))||new Promise((t=>{this.sessionsStatus[e]=!1,this.channel.postMessage({type:i.Ping,fromSessionUUID:this.session.getUUID(),toSessionUUID:e}),setTimeout((()=>t(this.sessionsStatus[e])),250)}))}))}},t.MonoChannel=class{constructor(){this.onForceSendCb=()=>{},this.leaderPromise=Promise.resolve()}setCurrentSession(e){this.session=e}isLeader(){return!0}isSessionActive(e){return n(this,void 0,void 0,(function*(){const t=!!this.session;return!this.session||t&&this.session.getUUID()===e}))}notifyForceSend(){this.onForceSendCb()}onForceSend(e){this.onForceSendCb=e}onHasBecomeLeader(){return this.leaderPromise}}},5049:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CommandType=void 0,(r=t.CommandType||(t.CommandType={})).AddIssue="add-issue",r.AddLogEntry="add-log-entry",r.AddLogMessage="add-log-message",r.ForceSendOnce="force-send-once",r.SetDeviceKey="set-device-key"},6871:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0,t.Connection=class{constructor(e){this.window=e}isOnline(){return this.window.navigator.onLine}}},3256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentSession=void 0;const n=r(8177);t.CurrentSession=class{constructor(e,t,r,n,o){this.device=e,this.logger=t,this.sessionStorage=r,this.sessionsTable=n,this.uuidFactory=o,this.reset()}getUUID(){return this.uuid}initSession(){const e=this.device.getUDID();this.logger.log("Init session"),this.uuid=this.uuidFactory.create(),this.sessionStorage.setItem(n.SessionStorageKey.SessionUUID,this.uuid),this.sessionStorage.setItem(n.SessionStorageKey.SessionUDID,e)}reset(){const e=this.sessionStorage.getItem(n.SessionStorageKey.SessionUUID);null===e?(this.logger.log("Session not available"),this.initSession()):(this.uuid=e,this.sessionStorage.getItem(n.SessionStorageKey.SessionUDID)!==this.device.getUDID()?(this.logger.log("Session Device UDID changed"),this.initSession()):this.logger.log(`Session UUID: ${this.uuid}`)),this.sessionsTable.addIfMissing({uuid:this.uuid,udid:this.device.getUDID()})}}},6422:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Database=void 0;const i=r(2998),s=r(8593);var a;!function(e){e[e.New=0]="New",e[e.V1=10]="V1",e[e.V2=20]="V2"}(a||(a={})),t.Database=class{constructor(e){this.db=(0,s.createDeferred)(),this.name=null!=e?e:"bf_sdk",this.init()}init(){return n(this,void 0,void 0,(function*(){const e=yield(0,i.openDB)(this.name,a.V2,{upgrade(e,t,r,i){var s,c,u,l;return n(this,void 0,void 0,(function*(){if(t===a.New&&(e.createObjectStore("devicekeys",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("issues",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("logs",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("sessions",{keyPath:"uuid"})),t===a.V1){const e=i.objectStore("issues");try{for(var r,n=!0,d=o(e);r=yield d.next(),!(s=r.done);){l=r.value,n=!1;try{const e=l,t=Object.assign({},e.value);t.data.text=t.data.markdown,delete t.data.markdown,e.update(t)}finally{n=!0}}}catch(e){c={error:e}}finally{try{n||s||!(u=d.return)||(yield u.call(d))}finally{if(c)throw c.error}}}}))}});this.db.resolve(e)}))}get(){return this.db.promise}}},1177:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryDeviceKeysTable=t.IDBDeviceKeysTable=void 0,t.IDBDeviceKeysTable=class{constructor(e){this.table=e}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteBatch(e){return this.table.deleteBatch(0,e)}getAll(){return this.table.getAll()}},t.InMemoryDeviceKeysTable=class{constructor(){this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteBatch(e){return r(this,void 0,void 0,(function*(){this.data.splice(0,e)}))}getAll(){return r(this,void 0,void 0,(function*(){return[...this.data]}))}}},8808:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorage=void 0,t.InMemoryStorage=class{constructor(){this.inMemoryStorage={}}clear(){this.inMemoryStorage={}}getItem(e){return Object.prototype.hasOwnProperty.call(this.inMemoryStorage,e)?this.inMemoryStorage[e]:null}key(e){var t;return null!==(t=Object.keys(this.inMemoryStorage)[e])&&void 0!==t?t:null}removeItem(e){delete this.inMemoryStorage[e]}setItem(e,t){this.inMemoryStorage[e]=String(t)}get length(){return Object.keys(this.inMemoryStorage).length}}},7941:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryIssuesTable=t.IDBIssuesTable=void 0,t.IDBIssuesTable=class{constructor(e){this.table=e}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteById(e){return this.table.deleteByIdx(e)}getBatch(e,t){return this.table.getBatch(e,t)}},t.InMemoryIssuesTable=class{constructor(){this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteById(e){return r(this,void 0,void 0,(function*(){const t=this.data.findIndex((t=>t.id===e));-1!==t&&this.data.splice(t,1)}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).slice(0,t)}))}}},3856:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryLogsTable=t.IDBLogsTable=void 0,t.IDBLogsTable=class{constructor(e,t){this.table=e,this.logFactory=t}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteBatch(e,t){return this.table.deleteBatch(0,t,["sessionUUID",e])}deleteOldLogs(e,t=10){return r(this,void 0,void 0,(function*(){const r=yield this.table.getBatch(e,t);if(r.length<=1)return;const n={sessionUUID:e,data:this.logFactory.createGapLog(r.map((e=>e.data)))};yield Promise.all([this.table.patchByIdx(r[0].id,n),this.table.deleteBatch(1,t-1,["sessionUUID",e])])}))}getBatch(e,t){return this.table.getBatch(e,t)}},t.InMemoryLogsTable=class{constructor(e,t){this.logFactory=e,this.storageLimit=t,this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){if(this.data.length>=this.storageLimit){const e=new Error("InMemory storage quota exceeded");throw e.name="QuotaExceededError",e}const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteBatch(e,t){return r(this,void 0,void 0,(function*(){const r=[];let n=0;for(let o=0;o<this.data.length;o++){const i=this.data[o];i.sessionUUID===e&&n<t?n++:r.push(i)}this.data=r}))}deleteOldLogs(e){return r(this,void 0,void 0,(function*(){const e=this.data.slice(0,10);e.length<=1||(this.data[0].data=this.logFactory.createGapLog(e.map((e=>e.data))),this.data.splice(1,9))}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).slice(0,t)}))}}},253:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemorySessionsTable=t.IDBSessionsTable=void 0,t.IDBSessionsTable=class{constructor(e){this.table=e}addIfMissing(e){return r(this,void 0,void 0,(function*(){if(0===(yield this.table.countBy("uuid",e.uuid)))return this.table.add(e)}))}delete(e){return this.table.deleteByIdx(e)}getAll(){return this.table.getAll()}update(e,t){return this.table.patchByIdx(e,t)}},t.InMemorySessionsTable=class{constructor(){this.data=[]}addIfMissing(e){return r(this,void 0,void 0,(function*(){this.data.some((t=>t.uuid===e.uuid))||this.data.push(e)}))}delete(e){return r(this,void 0,void 0,(function*(){const t=this.data.findIndex((t=>t.uuid===e));-1!==t&&this.data.splice(t,1)}))}getAll(){return r(this,void 0,void 0,(function*(){return[...this.data]}))}update(e,t){return r(this,void 0,void 0,(function*(){const r=this.data.findIndex((t=>t.uuid===e));-1!==r&&(this.data[r]=Object.assign(Object.assign({},this.data[r]),t))}))}}},7967:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Table=void 0,t.Table=class{constructor(e,t){this.dbPromise=e,this.store=t}add(e){return r(this,void 0,void 0,(function*(){yield(yield this.dbPromise).add(this.store,e)}))}clear(){return r(this,void 0,void 0,(function*(){yield(yield this.dbPromise).clear(this.store)}))}countBy(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readonly");let n,o=0;if(e!==r.store.keyPath){const o=r.store.index(e),i=IDBKeyRange.only(t);n=yield o.openCursor(i)}else n=yield r.store.openCursor(IDBKeyRange.only(t));for(;n;)o++,n=yield n.continue();return o}))}deleteBatch(e,t,n){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readwrite");let o,i=0;if(n)if(n[0]!==r.store.keyPath){const e=r.store.index(n[0]),t=IDBKeyRange.only(n[1]);o=yield e.openCursor(t)}else o=yield r.store.openCursor(IDBKeyRange.only(n[1]));else o=yield r.store.openCursor();for(;o&&(i>=e&&o.delete(),i++,i!==e+t);)o=yield o.continue()}))}deleteByIdx(e){return r(this,void 0,void 0,(function*(){return(yield this.dbPromise).delete(this.store,e)}))}getAll(){return r(this,void 0,void 0,(function*(){return(yield this.dbPromise).getAll(this.store)}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readonly").store.index("sessionUUID"),n=IDBKeyRange.only(e);let o=yield r.openCursor(n);const i=[];let s=0;for(;o&&(i.push(o.value),s++,s!==t);)o=yield o.continue();return i}))}patchByIdx(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readwrite"),n=yield r.store.get(e);yield r.store.put(Object.assign(Object.assign({},n),t))}))}}},8955:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Device=void 0;const n=r(8177);t.Device=class{constructor(e,t,r,n){this.browser=e,this.localStorage=t,this.sdkVersion=r,this.uuidFactory=n}getDeviceData(){let e=this.localStorage.getItem(n.LocalStorageKey.DeviceData);return null===e&&(e="{}"),JSON.parse(e)}getInfo(e){return{udid:this.getUDID(),name:e.deviceName,device_type:"",firebase_test_lab:!1,key_values:this.getDeviceData(),language:this.browser.getLanguage(),os_version:this.browser.getOSVersion(),sdk_type:"web",sdk_version:this.sdkVersion.toString(),build:e.build,version:e.version}}getUDID(){let e=this.localStorage.getItem(n.LocalStorageKey.DeviceUDID);return null===e&&(e=this.uuidFactory.create(),this.localStorage.setItem(n.LocalStorageKey.DeviceUDID,e)),e}setDeviceKey(e,t){const r=this.getDeviceData();null===t?delete r[e]:r[e]=t,this.localStorage.setItem(n.LocalStorageKey.DeviceData,JSON.stringify(r))}}},9075:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClient=void 0,t.HttpClient=class{constructor(e,t,r){this.apiURL=e,this.appKey=t,this.sdkUserAgent=r}post(e,t){const r=new XMLHttpRequest;return r.open("POST",this.apiURL+e),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.setRequestHeader("X-User-Agent",this.sdkUserAgent),r.setRequestHeader("X-App-Token",this.appKey),new Promise(((e,n)=>{r.onreadystatechange=()=>{4===r.readyState&&(200!==r.status&&304!==r.status?n():e(JSON.parse(r.responseText)))},r.send(JSON.stringify(t))}))}}},8572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogFactory=void 0;const n=r(7431);t.LogFactory=class{constructor(e=32e3){this.maxLogLength=e}createFromDeviceKey(e,t,r,n){return this.createFromEntry({tag:"bf_key_value",text:`Set device data "${e}"="${t}"`},r,n)}createFromEntry(e,t,r){var o,i,s,a,c,u,l,d,p,f;let y=null!==(o=e.text)&&void 0!==o?o:"";return y.length>=this.maxLogLength&&(y=y.substring(0,this.maxLogLength)+"…"),{x:r.iso,t:y,m:null!==(s=null!==(i=e.method)&&void 0!==i?i:t.method)&&void 0!==s?s:"",at:r.epoch,tg:null!==(a=e.tag)&&void 0!==a?a:"",f:null!==(u=null!==(c=e.file)&&void 0!==c?c:t.file)&&void 0!==u?u:"",l:null!==(d=null!==(l=e.line)&&void 0!==l?l:t.line)&&void 0!==d?d:0,ll:null!==(p=e.level)&&void 0!==p?p:n.LogLevel.Debug,u:null!==(f=e.url)&&void 0!==f?f:""}}createFromIssue(e,t,r){return this.createFromEntry({level:n.LogLevel.Error,tag:"bf_issue",text:e},t,r)}createGapLog(e){const t=JSON.stringify({bf_start_date:e[0].at,bf_end_date:e[e.length-1].at});return{x:e[0].x,t,m:"",at:e[0].at,tg:"bf_gap_log",f:"",l:0,ll:0,u:e[0].u}}}},5473:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoopLogger=t.ConsoleLogger=void 0;class r{constructor(e,t){this.console=e,this.tag=t}error(e,t){e=`[BF-SDK]${this.tag?`[${this.tag}] `:""}${e}`,t?this.console.log(e,t):this.console.log(e)}getTagged(e){return new r(this.console,e)}log(e,t){e=`[BF-SDK]${this.tag?`[${this.tag}] `:""}${e}`,t?this.console.log(e,t):this.console.log(e)}}t.ConsoleLogger=r;class n{error(){}getTagged(){return new n}log(){}}t.NoopLogger=n},7935:function(e,t,r){"use strict";var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MainProvider=void 0;const a=r(7431),c=r(1562),u=r(2329),l=r(277),d=r(5881),p=r(6110),f=r(6871),y=r(3256),h=r(6422),g=r(7967),v=r(1177),b=r(8808),m=r(7941),w=r(3856),S=r(253),I=r(8955),O=r(9075),P=r(8572),E=r(5473),D=r(6105),j=r(7273),_=r(1310),A=r(3103),L=r(5041),T=r(6693),x=r(84),M=r(8593),U=s(r(4657)),B=r(4319),k=new Map,C=(0,M.CacheDecoratorFactory)(k);class F{constructor(e,t,r,n){this.options=e,this.preInitProvider=t,this.sdkUserAgent=r,this.version=n,this.apiFeatures=this.preInitProvider.provideAPIFeatureDetection(),this.commandsQueue=this.preInitProvider.provideCommandsQueue(),this.console=this.preInitProvider.provideWindow().console,this.operationModes=this.preInitProvider.provideOperationModes(),this.uuidFactory=this.preInitProvider.provideUUIDFactory(),this.window=this.preInitProvider.provideWindow()}getApiClient(){const e=new O.HttpClient(this.options.apiURL,this.options.appKey,this.sdkUserAgent);return new c.ApiClient(this.options.appKey,e)}getChannel(){return i(this,void 0,void 0,(function*(){let e;return e=(yield this.operationModes.isMultiTab())?new p.Channel((0,p.createBroadcastChannel)(),this.getLogger("Channel")):new p.MonoChannel,this.getCurrentSession().then((t=>{e.setCurrentSession(t)})),e}))}getConnection(){return new f.Connection(this.window)}getCurrentSession(){return i(this,void 0,void 0,(function*(){return new y.CurrentSession(this.getDevice(),this.getLogger("CurrentSession"),this.getSessionStorage(),yield this.getSessionsTable(),this.uuidFactory)}))}getDatabase(){return new h.Database}getDevice(){return new I.Device(this.preInitProvider.provideBrowser(),this.getLocalStorage(),this.version,this.uuidFactory)}getInitDeferred(){return(0,M.createDeferred)()}getDeviceKeysTable(){return i(this,void 0,void 0,(function*(){return(yield this.operationModes.isMultiTab())?new v.IDBDeviceKeysTable(new g.Table(this.getDatabase().get(),"devicekeys")):new v.InMemoryDeviceKeysTable}))}getIssuesTable(){return i(this,void 0,void 0,(function*(){return(yield this.operationModes.isMultiTab())?new m.IDBIssuesTable(new g.Table(this.getDatabase().get(),"issues")):new m.InMemoryIssuesTable}))}getLogger(e){return this.options.debug?new E.ConsoleLogger(this.console,e):new E.NoopLogger}getLogsTable(){return i(this,void 0,void 0,(function*(){return(yield this.operationModes.isMultiTab())?new w.IDBLogsTable(new g.Table(this.getDatabase().get(),"logs"),new P.LogFactory):new w.InMemoryLogsTable(new P.LogFactory,3e3)}))}getOverrideConsoleMethods(){return new u.OverrideConsoleMethods(this.commandsQueue,this.window)}getPrintToConsole(){return new a.PrintToConsole(this.console)}getRegisterBrowserEventsHandler(){return new l.RegisterBrowserEventsHandler(this.commandsQueue,this.window)}getRegisterErrorHandler(){return new a.RegisterErrorHandler(this.window)}getRegisterUIEventsHandler(){return new d.RegisterUIEventsHandler(this.commandsQueue,this.window)}getResetStorage(){return i(this,void 0,void 0,(function*(){return new D.ResetStorage(this.apiFeatures,yield this.getCurrentSession(),this.getDatabase(),this.getLocalStorage(),this.getSessionStorage())}))}getStorageGuard(){return new _.StorageGuard(this.getApiClient(),this.getDevice(),this.getLogger("StorageGuard"),this.options)}getStorageProcessor(){return i(this,void 0,void 0,(function*(){const e=new j.SessionFactory(this.getDevice(),this.version,this.window);return new A.StorageProcessor(this.getApiClient(),yield this.getChannel(),this.getConnection(),this.getLogger("StorageProcessor"),this.getDevice(),yield this.getDeviceKeysTable(),yield this.getIssuesTable(),yield this.getLogsTable(),this.options,e,yield this.getSessionsTable(),yield this.getStorageGuard())}))}getStorageWriterHub(){return i(this,void 0,void 0,(function*(){let e;return e=(yield this.operationModes.isMultiThread())?new U.default:new T.MainThreadStorageWriterHandler(new L.StorageWriter(yield this.getDeviceKeysTable(),yield this.getIssuesTable(),new P.LogFactory,yield this.getLogsTable())),new x.StorageWriterHub(yield this.getChannel(),this.getDevice(),e,new B.EventPrinter(this.console,this.options.printToConsole),this.options,this.getPrintToConsole(),yield this.getCurrentSession(),yield this.getStorageGuard(),this.uuidFactory,this.window)}))}getLocalStorage(){return this.apiFeatures.isLocalStorageSupported()?this.window.localStorage:new b.InMemoryStorage}getSessionStorage(){return this.apiFeatures.isSessionStorageSupported()?this.window.sessionStorage:new b.InMemoryStorage}getSessionsTable(){return i(this,void 0,void 0,(function*(){return(yield this.operationModes.isMultiTab())?new S.IDBSessionsTable(new g.Table(this.getDatabase().get(),"sessions")):new S.InMemorySessionsTable}))}}n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Object)],F.prototype,"getApiClient",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getChannel",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",f.Connection)],F.prototype,"getConnection",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getCurrentSession",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",h.Database)],F.prototype,"getDatabase",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Object)],F.prototype,"getDevice",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Object)],F.prototype,"getInitDeferred",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getDeviceKeysTable",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getIssuesTable",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getLogsTable",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",u.OverrideConsoleMethods)],F.prototype,"getOverrideConsoleMethods",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",a.PrintToConsole)],F.prototype,"getPrintToConsole",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",l.RegisterBrowserEventsHandler)],F.prototype,"getRegisterBrowserEventsHandler",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",a.RegisterErrorHandler)],F.prototype,"getRegisterErrorHandler",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",d.RegisterUIEventsHandler)],F.prototype,"getRegisterUIEventsHandler",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getResetStorage",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Object)],F.prototype,"getStorageGuard",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getStorageProcessor",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getStorageWriterHub",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Storage)],F.prototype,"getLocalStorage",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Storage)],F.prototype,"getSessionStorage",null),n([C(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],F.prototype,"getSessionsTable",null),t.MainProvider=F},6105:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ResetStorage=void 0;const o=r(8177);t.ResetStorage=class{constructor(e,t,r,n,o){this.apiFeatures=e,this.session=t,this.database=r,this.localStorage=n,this.sessionStorage=o}resetIfAppChanged(e){return n(this,void 0,void 0,(function*(){const t=this.localStorage.getItem(o.LocalStorageKey.AppID);if(null!==t&&t!==e){const e=[o.LocalStorageKey.AppID,o.LocalStorageKey.DeviceData,o.LocalStorageKey.DeviceUDID],t=[o.SessionStorageKey.SessionUDID,o.SessionStorageKey.SessionUUID];if(e.forEach((e=>this.localStorage.removeItem(e))),t.forEach((e=>this.sessionStorage.removeItem(e))),this.session.reset(),yield this.apiFeatures.isIndexedDBSupported()){const e=yield this.database.get();yield Promise.all([e.clear("devicekeys"),e.clear("issues"),e.clear("logs"),e.clear("sessions")])}}this.localStorage.setItem(o.LocalStorageKey.AppID,e)}))}}},7273:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionFactory=void 0,t.SessionFactory=class{constructor(e,t,r){this.device=e,this.sdkVersion=t,this.window=r}create(e,t){return{device:this.device.getInfo(t),orientation:0,batteryLevel:-1,ram_total:0,ram_free:0,ram_used:0,language:this.window.navigator.language,time:(new Date).toISOString(),sdk_type:"web",sdk_version:this.sdkVersion,session_uid:e,app_version:{app:{key:t.appKey},version:t.version,build:t.build}}}}},1310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageGuard=void 0,t.StorageGuard=class{constructor(e,t,r,n){this.api=e,this.device=t,this.logger=r,this.options=n,this.deviceForceEnabled=!1,this.isAppValid=!0,this.isDeviceEnabled=!1,this.checkIsDeviceEnabled(),setInterval(this.checkIsDeviceEnabled.bind(this),3e5)}canProcess(){return this.logger.log("canProcess",{isAppValid:this.isAppValid,isDeviceEnabled:this.isDeviceEnabled,deviceForceEnabled:this.deviceForceEnabled}),this.isAppValid&&(this.isDeviceEnabled||this.deviceForceEnabled)}canWrite(){return this.isAppValid}checkIsDeviceEnabled(){const e=this.device.getInfo(this.options);return this.api.getDeviceStatus(e).then((e=>{this.isAppValid=e.isAppValid,this.isDeviceEnabled=e.isDeviceEnabled}),(()=>{}))}setDeviceForceEnabled(e){this.deviceForceEnabled=e}}},8177:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorageKey=t.LocalStorageKey=void 0,(n=t.LocalStorageKey||(t.LocalStorageKey={})).AppID="bf_app_id",n.DeviceData="bf_device_data",n.DeviceUDID="bf_device_udid",(r=t.SessionStorageKey||(t.SessionStorageKey={})).SessionUDID="bf_session_udid",r.SessionUUID="bf_session_uuid"},3103:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageProcessor=void 0,t.StorageProcessor=class{constructor(e,t,r,n,o,i,s,a,c,u,l,d){this.api=e,this.channel=t,this.connection=r,this.logger=n,this.device=o,this.deviceKeysTable=i,this.issuesTable=s,this.logsTable=a,this.options=c,this.sessionFactory=u,this.sessionsTable=l,this.storageGuard=d,this.BATCH_SIZE=500,this.runIntervalMs=15e3,this.forceSend=!1,this.isRunning=!1,setInterval(this.run.bind(this),this.runIntervalMs),this.channel.onHasBecomeLeader().then((()=>{this.run()})),this.channel.onForceSend((()=>{this.forceSend=!0}))}cleanupSessions(e){return r(this,void 0,void 0,(function*(){for(const t of e){const e=yield this.channel.isSessionActive(t.uuid),r=yield this.hasData(t);if(!e&&!r)try{yield this.sessionsTable.delete(t.uuid)}catch(e){}}}))}hasData(e){return r(this,void 0,void 0,(function*(){try{const[t,r,n]=yield Promise.all([this.logsTable.count(e.uuid),this.issuesTable.count(e.uuid),this.deviceKeysTable.count(e.uuid)]);return t>0||r>0||n>0}catch(e){return!0}}))}registerSession(e){return r(this,void 0,void 0,(function*(){if(!e.id){const t=this.sessionFactory.create(e.uuid,this.options),{id:r}=yield this.api.sendSession(t);e.id=r,this.sessionsTable.update(e.uuid,{id:r})}return e}))}canRun(){return this.connection.isOnline()&&this.channel.isLeader()&&!this.isRunning}run(){return r(this,void 0,void 0,(function*(){const e=this.canRun();if(this.logger.log("Processing...",{forceSend:this.forceSend,isRunning:this.isRunning,isLeader:this.channel.isLeader(),isOnline:this.connection.isOnline(),canRun:e}),!e)return void this.logger.log("Aborted.");this.isRunning=!0;const t=this.forceSend,r=yield this.sessionsTable.getAll(),n=[],o=this.storageGuard.canProcess()||this.forceSend;let i=!1;this.logger.log("Should process device: "+(o?"Yes":"No")),this.logger.log(`${r.length} session/s found`),r.sort(((e,t)=>Number(!!t.id)-Number(!!e.id)));for(const e of r){const t=yield this.registerSession(e),r=yield this.sendIssues(t);i=i||r,r||o?(n.push(this.sendLogs(t)),this.logger.log(`Session processed. ID: ${t.id}`,{sessionHasIssues:r})):this.logger.log(`Session skipped. ID: ${t.id}`)}(i||o)&&n.push(this.sendDeviceData()),yield Promise.all(n),yield this.cleanupSessions(r),this.isRunning=!1,t&&(this.forceSend=!1),this.logger.log("Done")}))}sendDeviceData(){return r(this,void 0,void 0,(function*(){try{const e={},t=yield this.deviceKeysTable.getAll();t.forEach((t=>{e[t.data.key]=t.data.value})),t.length&&(yield Promise.all(Object.entries(e).map((([e,t])=>this.api.setDeviceKey(this.device.getUDID(),e,t)))),yield this.deviceKeysTable.deleteBatch(t.length))}catch(e){this.logger.error("sendDeviceData error",e)}}))}sendIssues(e){return r(this,void 0,void 0,(function*(){try{const t=yield this.issuesTable.getBatch(e.uuid,this.BATCH_SIZE);for(const r of t){const t=r.data,n=`${this.options.baseURL}/intent/${this.options.appID}/issue/${t.uuid}`;yield this.api.sendIssue(t.uuid,n,t.title,t.text,t.type,e.id),yield this.issuesTable.deleteById(r.id)}return t.length>0}catch(e){return this.logger.error("sendIssues error",e),!1}}))}sendLogs(e){return r(this,void 0,void 0,(function*(){try{const t=(yield this.logsTable.getBatch(e.uuid,this.BATCH_SIZE)).map((e=>e.data));t.length&&(yield this.api.sendLogs(e.id,t),yield this.logsTable.deleteBatch(e.uuid,t.length))}catch(e){this.logger.error("sendLogs error",e)}}))}}},6693:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainThreadStorageWriterHandler=void 0,t.MainThreadStorageWriterHandler=class{constructor(e){this.storageWriter=e}postMessage(e){this.storageWriter.handleMessage(e)}}},84:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageWriterHub=void 0;const n=r(7431),o=r(3817),i=r(5049),s=r(2607);t.StorageWriterHub=class{constructor(e,t,r,n,i,s,a,c,u,l){this.channel=e,this.device=t,this.handler=r,this.eventPrinter=n,this.options=i,this.printToConsole=s,this.session=a,this.storageGuard=c,this.uuidFactory=u,this.window=l,this.sanitizer=new o.StorageWriterSanitizer}init(e){const t=this.session.getUUID();this.options=e,this.postMessage({type:"init",data:{options:e,sessionUUID:t}},!1)}postMessage(e,t=!0){if(!t||this.storageGuard.canWrite())try{this.handler.postMessage(this.sanitizer.sanitize(e))}catch(e){}}addDeviceKey(e){if("string"!=typeof e.key)throw new Error("The device-key 'key' must be a string.");this.device.setDeviceKey(e.key,e.value),this.postMessage({type:"device-key",data:{key:e.key,value:e.value,callInfo:e.callInfo,time:e.time}}),this.eventPrinter.printDeviceKey(e.key,e.value)}addLogEntry(e,t=!0){var r;e.log.url=(null!==(r=e.log.url)&&void 0!==r?r:this.window)?this.window.location.href:"";const n=this.mapToLogEntryText(e.log);this.postMessage({type:"log-entry",data:{log:n,callInfo:e.callInfo,time:e.time}}),t&&(this.isJsEventLogEntry(n)?this.eventPrinter.printJsEvent(n):this.printToConsole.printLog(n))}isJsEventLogEntry(e){return"js_event"===e.tag&&"string"==typeof e.text&&"string"==typeof e.url}mapToLogEntryText(e){return e.text&&(e.text=(0,n.formatLogEntryText)(e.text)),e}addLogMessage(e){const t={};switch(t.level=e.level,t.text=(0,n.format)(e.parameters),t.url=this.window?this.window.location.href:void 0,this.addLogEntry({type:i.CommandType.AddLogEntry,log:t,callInfo:e.callInfo,time:e.time},!1),e.level){case n.LogLevel.Debug:this.printToConsole.log(...e.parameters);break;case n.LogLevel.Warning:this.printToConsole.warn(...e.parameters);break;case n.LogLevel.Error:this.printToConsole.error(...e.parameters);break;case n.LogLevel.Trace:this.printToConsole.trace(...e.parameters);break;case n.LogLevel.Info:this.printToConsole.info(...e.parameters);break;case n.LogLevel.Fatal:this.printToConsole.error(...e.parameters)}}addIssue(e){if("string"!=typeof e.title)throw new Error("The crash/issue/feedback 'title' must be a string.");switch(this.postMessage({type:"issue",data:{type:e.issueType,title:e.title,uuid:e.uuid,text:e.text,callInfo:e.callInfo,time:e.time}}),this.forceSendOnce(),e.url.resolve(`${this.options.baseURL}/intent/${this.options.appID}/issue/${e.uuid}`),e.issueType){case s.IssueType.Issue:this.printToConsole.warn(`Issue: ${e.title}.\n${e.text}`);break;case s.IssueType.Crash:this.printToConsole.error(`Crash: ${e.title}.\n${e.text}`);break;case s.IssueType.Feedback:this.printToConsole.info(`User Feedback: ${e.title}.\n${e.text}`)}}forceSendOnce(){this.channel.notifyForceSend()}}},3817:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageWriterSanitizer=void 0;const n=r(7431);t.StorageWriterSanitizer=class{sanitize(e){switch(e.type){case"device-key":{const t=["boolean","number","string"].includes(typeof e.data.value);e.data.key=(0,n.mapToString)(e.data.key),t||(e.data.value=(0,n.mapToString)(e.data.value));break}case"issue":e.data.title=(0,n.mapToString)(e.data.title),e.data.text=(0,n.mapToString)(e.data.text);break;case"log-entry":{const t=["tag","method","file","text","url"],r="line"in e.data.log&&void 0!==e.data.log.line,o=r&&"number"==typeof e.data.log.line,i="level"in e.data.log&&void 0!==e.data.log.level,s=i&&n.LOG_LEVELS.includes(e.data.log.level);if(t.forEach((t=>{if(t in e.data.log&&void 0!==e.data.log[t])try{e.data.log[t]=(0,n.mapToString)(e.data.log[t])}catch(r){delete e.data.log[t]}})),r&&!o)try{e.data.log.line=(0,n.mapToNumber)(e.data.log.line)}catch(t){delete e.data.log.line}if(i&&!s)try{e.data.log.level=(0,n.mapToNumber)(e.data.log.level),n.LOG_LEVELS.includes(e.data.log.level)||delete e.data.log.level}catch(t){delete e.data.log.level}break}}return e}}},5041:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageWriter=void 0,t.StorageWriter=class{constructor(e,t,r,n){this.deviceKeysTable=e,this.issuesTable=t,this.logFactory=r,this.logsTable=n,this.isClearingSpace=!1,this.logsQueue=[]}handleMessage(e){return r(this,void 0,void 0,(function*(){switch(e.type){case"device-key":return this.addDeviceKey(e.data.key,e.data.value,e.data.callInfo,e.data.time);case"init":this.options=e.data.options,this.sessionUUID=e.data.sessionUUID;break;case"issue":return this.addIssue(e.data.type,e.data.title,e.data.text,e.data.uuid,e.data.callInfo,e.data.time);case"log-entry":return this.addLogEntry(e.data.log,e.data.callInfo,e.data.time)}}))}addDeviceKey(e,t,r,n){this.deviceKeysTable.add({sessionUUID:this.sessionUUID,data:{key:e,value:t}}),this.addLog(this.logFactory.createFromDeviceKey(e,t,r,n))}addLog(e){return r(this,void 0,void 0,(function*(){const t={sessionUUID:this.sessionUUID,data:e};if(this.isClearingSpace)this.logsQueue.push(t);else try{yield this.logsTable.add(t)}catch(e){this.isQuotaExceededError(e)&&(this.logsQueue.push(t),this.isClearingSpace=!0,yield this.logsTable.deleteOldLogs(this.sessionUUID),yield this.processLogsQueue(),this.isClearingSpace=!1)}}))}addLogEntry(e,t,r){this.addLog(this.logFactory.createFromEntry(e,t,r))}addIssue(e,t,r,n,o,i){this.issuesTable.add({sessionUUID:this.sessionUUID,data:{title:t,text:r,type:e,uuid:n}}),this.addLog(this.logFactory.createFromIssue(n,o,i))}isQuotaExceededError(e){var t;return"QuotaExceededError"===e.name||"QuotaExceededError"===(null===(t=e.inner)||void 0===t?void 0:t.name)}processLogsQueue(){return r(this,void 0,void 0,(function*(){for(;this.logsQueue.length>0;){const e=this.logsQueue[0];try{yield this.logsTable.add(e),this.logsQueue.shift()}catch(e){this.isQuotaExceededError(e)&&(yield this.logsTable.deleteOldLogs(this.sessionUUID))}}}))}}},2607:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.IssueType=void 0,(r=t.IssueType||(t.IssueType={})).Issue="issue",r.Crash="crash",r.Feedback="user-feedback"},8593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElByXPath=t.getXPath=t.DebounceByElement=t.UnreachableCaseError=t.CacheDecoratorFactory=t.createDeferred=void 0,t.createDeferred=function(){const e={isFulfilled:!1,isRejected:!1,isResolved:!1};return e.promise=new Promise(((t,r)=>{e.resolve=r=>{const n=e;n.isFulfilled=!0,n.isRejected=!1,n.isResolved=!0,n.value=r,t(r)},e.reject=t=>{const n=e;n.isFulfilled=!0,n.isRejected=!0,n.isResolved=!1,n.err=t,r(t)}})),e},t.CacheDecoratorFactory=function(e){return function(){return function(t,r,n){const o=n.value;n.value=function(){return e.has(r)||e.set(r,o.apply(this)),e.get(r)}}}};class r extends Error{constructor(e){super(`Unreachable case: ${JSON.stringify(e)}`)}}t.UnreachableCaseError=r,t.DebounceByElement=class{constructor(e){this.wait=e,this.timers=new Map}run(e,t){this.timers.has(e)&&clearTimeout(this.timers.get(e)),this.timers.set(e,setTimeout((()=>{t(),this.timers.delete(e)}),this.wait))}},t.getXPath=function(e){let t=e;if(t instanceof Element&&t.id)return'//*[@id="'+t.id+'"]';const r=[];for(;t&&t instanceof Element;){const e=t;let n=0,o=!1,i=e.previousSibling;for(;i;)i.nodeType!==Node.DOCUMENT_TYPE_NODE&&i.nodeName===e.nodeName&&n++,i=i.previousSibling;for(i=e.nextSibling;i;){if(i.nodeName===e.nodeName){o=!0;break}i=i.nextSibling}const s=e.prefix?e.prefix+":":"",a=n||o?`[${n+1}]`:"";r.push(s+e.localName+a),t=e.parentNode}return r.length?"/"+r.reverse().join("/"):""},t.getElByXPath=function(e){var t;return null!==(t=document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue)&&void 0!==t?t:void 0}},4810:(e,t,r)=>{"use strict";r.r(t),r.d(t,{add:()=>c,getSize:()=>d,removeAll:()=>l,runAll:()=>u});var n=r(4155),o=r(4155),i="[object process]"===Object.prototype.toString.call(void 0!==o?o:0)?function(e){n.on("exit",(function(){return e()})),n.on("beforeExit",(function(){return e().then((function(){return n.exit()}))})),n.on("SIGINT",(function(){return e().then((function(){return n.exit()}))})),n.on("uncaughtException",(function(t){return e().then((function(){console.trace(t),n.exit(101)}))}))}:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}},s=new Set,a=!1;function c(e){if(a||(a=!0,i(u)),"function"!=typeof e)throw new Error("Listener is no function");return s.add(e),{remove:function(){return s.delete(e)},run:function(){return s.delete(e),e()}}}function u(){var e=[];return s.forEach((function(t){e.push(t()),s.delete(t)})),Promise.all(e)}function l(){s.clear()}function d(){return s.size}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},5955:(e,t,r)=>{"use strict";var n=r(2584),o=r(8662),i=r(6430),s=r(5692);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,l=a(Object.prototype.toString),d=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),f=a(Boolean.prototype.valueOf);if(c)var y=a(BigInt.prototype.valueOf);if(u)var h=a(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function v(e){return"[object Map]"===l(e)}function b(e){return"[object Set]"===l(e)}function m(e){return"[object WeakMap]"===l(e)}function w(e){return"[object WeakSet]"===l(e)}function S(e){return"[object ArrayBuffer]"===l(e)}function I(e){return"undefined"!=typeof ArrayBuffer&&(S.working?S(e):e instanceof ArrayBuffer)}function O(e){return"[object DataView]"===l(e)}function P(e){return"undefined"!=typeof DataView&&(O.working?O(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=o,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||P(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},v.working="undefined"!=typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(v.working?v(e):e instanceof Map)},b.working="undefined"!=typeof Set&&b(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(b.working?b(e):e instanceof Set)},m.working="undefined"!=typeof WeakMap&&m(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(m.working?m(e):e instanceof WeakMap)},w.working="undefined"!=typeof WeakSet&&w(new WeakSet),t.isWeakSet=function(e){return w(e)},S.working="undefined"!=typeof ArrayBuffer&&S(new ArrayBuffer),t.isArrayBuffer=I,O.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&O(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=P;var E="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function D(e){return"[object SharedArrayBuffer]"===l(e)}function j(e){return void 0!==E&&(void 0===D.working&&(D.working=D(new E)),D.working?D(e):e instanceof E)}function _(e){return g(e,d)}function A(e){return g(e,p)}function L(e){return g(e,f)}function T(e){return c&&g(e,y)}function x(e){return u&&g(e,h)}t.isSharedArrayBuffer=j,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=_,t.isStringObject=A,t.isBooleanObject=L,t.isBigIntObject=T,t.isSymbolObject=x,t.isBoxedPrimitive=function(e){return _(e)||A(e)||L(e)||T(e)||x(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(I(e)||j(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},9539:(e,t,r)=>{var n=r(4155),o=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<o;a=n[++r])v(a)||!I(a)?s+=" "+a:s+=" "+u(a);return s},t.deprecate=function(e,r){if(void 0!==n&&!0===n.noDeprecation)return e;if(void 0===n)return function(){return t.deprecate(e,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),o=!0}return e.apply(this,arguments)}};var s={},a=/^$/;if(n.env.NODE_DEBUG){var c=n.env.NODE_DEBUG;c=c.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+c+"$","i")}function u(e,r){var n={seen:[],stylize:d};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&t._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),p(n,e,n.depth)}function l(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function d(e,t){return e}function p(e,r,n){if(e.customInspect&&r&&E(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return m(o)||(o=p(e,o,n)),o}var i=function(e,t){if(w(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return b(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}(e,r);if(i)return i;var s=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),P(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(E(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(S(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(O(r))return e.stylize(Date.prototype.toString.call(r),"date");if(P(r))return f(r)}var u,l="",d=!1,I=["{","}"];return h(r)&&(d=!0,I=["[","]"]),E(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]"),S(r)&&(l=" "+RegExp.prototype.toString.call(r)),O(r)&&(l=" "+Date.prototype.toUTCString.call(r)),P(r)&&(l=" "+f(r)),0!==s.length||d&&0!=r.length?n<0?S(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=d?function(e,t,r,n,o){for(var i=[],s=0,a=t.length;s<a;++s)L(t,String(s))?i.push(y(e,t,r,n,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(y(e,t,r,n,o,!0))})),i}(e,r,n,a,s):s.map((function(t){return y(e,r,n,a,t,d)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(u,l,I)):I[0]+l+I[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function y(e,t,r,n,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),L(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=v(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),w(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function h(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function v(e){return null===e}function b(e){return"number"==typeof e}function m(e){return"string"==typeof e}function w(e){return void 0===e}function S(e){return I(e)&&"[object RegExp]"===D(e)}function I(e){return"object"==typeof e&&null!==e}function O(e){return I(e)&&"[object Date]"===D(e)}function P(e){return I(e)&&("[object Error]"===D(e)||e instanceof Error)}function E(e){return"function"==typeof e}function D(e){return Object.prototype.toString.call(e)}function j(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!s[e])if(a.test(e)){var r=n.pid;s[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else s[e]=function(){};return s[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(5955),t.isArray=h,t.isBoolean=g,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=w,t.isRegExp=S,t.types.isRegExp=S,t.isObject=I,t.isDate=O,t.types.isDate=O,t.isError=P,t.types.isNativeError=P,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":");return[e.getDate(),_[e.getMonth()],t].join(" ")}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",A(),t.format.apply(t,arguments))},t.inherits=r(5717),t._extend=function(e,t){if(!t||!I(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function x(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(T&&e[T]){var t;if("function"!=typeof(t=e[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),T&&Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,o(e))},t.promisify.custom=T,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var o=t.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,t).then((function(e){n.nextTick(s.bind(null,null,e))}),(function(e){n.nextTick(x.bind(null,e,s))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,o(e)),t}},6430:(e,t,r)=>{"use strict";var n=r(9804),o=r(3083),i=r(1924),s=i("Object.prototype.toString"),a=r(6410)(),c="undefined"==typeof globalThis?r.g:globalThis,u=o(),l=i("String.prototype.slice"),d={},p=r(882),f=Object.getPrototypeOf;a&&p&&f&&n(u,(function(e){if("function"==typeof c[e]){var t=new c[e];if(Symbol.toStringTag in t){var r=f(t),n=p(r,Symbol.toStringTag);if(!n){var o=f(r);n=p(o,Symbol.toStringTag)}d[e]=n.get}}}));var y=r(5692);e.exports=function(e){return!!y(e)&&(a&&Symbol.toStringTag in e?function(e){var t=!1;return n(d,(function(r,n){if(!t)try{var o=r.call(e);o===n&&(t=o)}catch(e){}})),t}(e):l(s(e),8,-1))}},4657:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(477),o=r.n(n);function i(){return o()('/*! For license information please see storage-writer.worker.worker.js.LICENSE.txt */\n(()=>{var e={496:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},431:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(496),t),o(r(704),t),o(r(596),t),o(r(836),t),o(r(758),t),o(r(922),t),o(r(287),t),o(r(484),t),o(r(929),t)},704:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_LEVELS=t.LogLevel=void 0,function(e){e[e.Debug=0]="Debug",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Trace=3]="Trace",e[e.Info=4]="Info",e[e.Fatal=5]="Fatal"}(r=t.LogLevel||(t.LogLevel={})),t.LOG_LEVELS=[r.Debug,r.Warning,r.Error,r.Trace,r.Info,r.Fatal]},596:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e){Object.entries(e).forEach((function(t){var r=t[0];void 0===t[1]&&delete e[r]}))}Object.defineProperty(t,"__esModule",{value:!0}),t.validate=t.removeUndefinedProperties=t.prepareOptions=void 0,t.prepareOptions=function(e){return n(e=r({},e)),function(e,t){["build","version"].forEach((function(t){var r=e[t];"string"==typeof r&&""===r.trim()&&delete e[t]}))}(e),e},t.removeUndefinedProperties=n,t.validate=function(e,t){var r=new RegExp(/^http(s)?:\\/\\//i);Object.entries(t).forEach((function(t){var n=t[0],o=t[1],i=e[n];o.forEach((function(e){if("required"===e){if(void 0===i)throw new Error("Bugfender requires \'".concat(n,"\' option to initialize."))}else if("string"===e){if(!["string","undefined"].includes(typeof i))throw new Error("\'".concat(n,"\' option must be a string."))}else if("url"===e){if(void 0!==i&&!r.test(i))throw new Error("\'".concat(n,"\' option must be a valid URL."))}else if("boolean"===e&&!["boolean","undefined"].includes(typeof i))throw new Error("\'".concat(n,"\' option must be a boolean."))}))}))}},836:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintToConsole=void 0;var n=r(539),o=r(704),i=function(){function e(e){this.console=e,this.printToConsole=!1}return e.prototype.init=function(e){this.printToConsole=e},e.prototype.error=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).error.apply(e,t)},e.prototype.info=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).info.apply(e,t)},e.prototype.log=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).log.apply(e,t)},e.prototype.debug=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).debug.apply(e,t)},e.prototype.trace=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).trace.apply(e,t)},e.prototype.warn=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.printToConsole&&(e=this.console).warn.apply(e,t)},e.prototype.printLog=function(e){if(this.printToConsole){var t=["log","warn","error","trace","info","error"][e.level||o.LogLevel.Debug],r=e.tag?"[".concat(e.tag,"] "):"",i=[e.file||"",e.method||"",e.line||""].filter((function(e){return""!==e})).join(":"),a="".concat(r).concat((0,n.format)(e.text)," ").concat(i);this.console[t](a)}},e}();t.PrintToConsole=i},758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterErrorHandler=void 0;var r=function(){function e(e){this.window=e,this.rejectionsMap=new Map}return e.prototype.init=function(e){var t=this;this.bugfender=e,this.window.addEventListener("error",(function(e){var r=e.message,n=e.lineno,o=e.filename,i=e.error;t.logError(r,o,n,i)})),this.window.addEventListener("unhandledrejection",(function(e){var r=setTimeout((function(){t.logError("Potentially unhandled promise",void 0,void 0,e.reason)}),1);t.rejectionsMap.set(e.promise,r),e.preventDefault()})),this.window.addEventListener("rejectionhandled",(function(e){clearTimeout(t.rejectionsMap.get(e.promise)),t.rejectionsMap.delete(e.promise)}))},e.prototype.logError=function(e,t,r,n){var o;n&&n.stack&&(o=n.stack),"string"==typeof e&&this.bugfender.sendCrash(e,["Error: ".concat(e),"URL: ".concat(null!=t?t:"N/A"),"Line: ".concat(null!=r?r:"N/A"),"Stack: ".concat(null!=o?o:"N/A")].join("\\n"))},e}();t.RegisterErrorHandler=r},922:function(e,t,r){"use strict";var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.formatLogEntryText=t.format=void 0;var o=r(539),i=r(287);function a(e){var t=e.slice(1),r=e[0];try{r=(0,i.mapToString)(r)}catch(e){r=(0,o.format)(r)}return t.length>0?o.format.apply(void 0,n([r],t,!1)):r}t.format=a,t.formatLogEntryText=function(e){return"string"==typeof e?e:function(e){return Array.isArray(e)}(e)?a(e):""}},287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToString=t.mapToNumber=void 0,t.mapToNumber=function(e){var t=Number(e);if(isNaN(t))throw new Error("Can\'t be casted to number");return t},t.mapToString=function(e){if(["string","symbol","bigint","function"].includes(typeof e)||e instanceof Error)try{return String(e)}catch(t){return JSON.stringify(e)}else try{return JSON.stringify(e)}catch(t){return String(e)}}},929:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.UserFeedbackOptionsValidator=void 0;var n={title:"Feedback",hint:"Please insert your feedback here and click send",subjectPlaceholder:"Subject…",feedbackPlaceholder:"Your feedback…",submitLabel:"Send",closeLabel:"Close"},o=function(){function e(){}return e.prototype.init=function(e){return r(r({},n),null!=e?e:{})},e}();t.UserFeedbackOptionsValidator=o},484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},924:(e,t,r)=>{"use strict";var n=r(210),o=r(559),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},559:(e,t,r)=>{"use strict";var n=r(612),o=r(210),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||n.call(a,i),c=o("%Object.getOwnPropertyDescriptor%",!0),u=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=s(n,a,arguments);if(c&&u){var r=c(t,"length");r.configurable&&u(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var f=function(){return s(n,i,arguments)};u?u(e.exports,"apply",{value:f}):e.exports.apply=f},804:e=>{var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(e,n,o){if("[object Function]"!==r.call(n))throw new TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var a=0;a<i;a++)n.call(o,e[a],a,e);else for(var s in e)t.call(e,s)&&n.call(o,e[s],s,e)}},648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,o="[object Function]";e.exports=function(e){var i=this;if("function"!=typeof i||n.call(i)!==o)throw new TypeError(t+i);for(var a,s=r.call(arguments,1),c=function(){if(this instanceof a){var t=i.apply(this,s.concat(r.call(arguments)));return Object(t)===t?t:this}return i.apply(e,s.concat(r.call(arguments)))},u=Math.max(0,i.length-s.length),l=[],f=0;f<u;f++)l.push("$"+f);if(a=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(c),i.prototype){var p=function(){};p.prototype=i.prototype,a.prototype=new p,p.prototype=null}return a}},612:(e,t,r)=>{"use strict";var n=r(648);e.exports=Function.prototype.bind||n},210:(e,t,r)=>{"use strict";var n,o=SyntaxError,i=Function,a=TypeError,s=function(e){try{return i(\'"use strict"; return (\'+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var u=function(){throw new a},l=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(e){return u}}}():u,f=r(405)(),p=Object.getPrototypeOf||function(e){return e.__proto__},y={},d="undefined"==typeof Uint8Array?n:p(Uint8Array),h={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":f?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":y,"%AsyncGenerator%":y,"%AsyncGeneratorFunction%":y,"%AsyncIteratorPrototype%":y,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":y,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&f?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&f?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f?p(""[Symbol.iterator]()):n,"%Symbol%":f?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":l,"%TypedArray%":d,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function e(t){var r;if("%AsyncFunction%"===t)r=s("async function () {}");else if("%GeneratorFunction%"===t)r=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=s("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(r=p(o.prototype))}return h[t]=r,r},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(612),m=r(642),w=v.call(Function.call,Array.prototype.concat),O=v.call(Function.apply,Array.prototype.splice),S=v.call(Function.call,String.prototype.replace),j=v.call(Function.call,String.prototype.slice),P=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|(["\'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,A=/\\\\(\\\\)?/g,I=function(e){var t=j(e,0,1),r=j(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return S(e,P,(function(e,t,r,o){n[n.length]=r?S(o,A,"$1"):t||e})),n},E=function(e,t){var r,n=e;if(m(b,n)&&(n="%"+(r=b[n])[0]+"%"),m(h,n)){var i=h[n];if(i===y&&(i=g(n)),void 0===i&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a(\'"allowMissing" argument must be a boolean\');var r=I(e),n=r.length>0?r[0]:"",i=E("%"+n+"%",t),s=i.name,u=i.value,l=!1,f=i.alias;f&&(n=f[0],O(r,w([0,1],f)));for(var p=1,y=!0;p<r.length;p+=1){var d=r[p],g=j(d,0,1),b=j(d,-1);if((\'"\'===g||"\'"===g||"`"===g||\'"\'===b||"\'"===b||"`"===b)&&g!==b)throw new o("property names with quotes must have matching quotes");if("constructor"!==d&&y||(l=!0),m(h,s="%"+(n+="."+d)+"%"))u=h[s];else if(null!=u){if(!(d in u)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&p+1>=r.length){var v=c(u,d);u=(y=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:u[d]}else y=m(u,d),u=u[d];y&&!l&&(h[s]=u)}}return u}},405:(e,t,r)=>{"use strict";var n=r.g.Symbol,o=r(419);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&o()}},419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},608:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},410:(e,t,r)=>{"use strict";var n=r(608);e.exports=function(){return n()&&!!Symbol.toStringTag}},642:(e,t,r)=>{"use strict";var n=r(612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},584:(e,t,r)=>{"use strict";var n=r(410)(),o=r(924)("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},a=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},s=function(){return i(arguments)}();i.isLegacyArguments=a,e.exports=s?i:a},662:(e,t,r)=>{"use strict";var n,o=Object.prototype.toString,i=Function.prototype.toString,a=/^\\s*(?:function)?\\*/,s=r(410)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(a.test(i.call(e)))return!0;if(!s)return"[object GeneratorFunction]"===o.call(e);if(!c)return!1;if(void 0===n){var t=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&c(t)}return c(e)===n}},692:(e,t,r)=>{"use strict";var n=r(804),o=r(83),i=r(924),a=i("Object.prototype.toString"),s=r(410)(),c="undefined"==typeof globalThis?r.g:globalThis,u=o(),l=i("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},f=i("String.prototype.slice"),p={},y=r(882),d=Object.getPrototypeOf;s&&y&&d&&n(u,(function(e){var t=new c[e];if(Symbol.toStringTag in t){var r=d(t),n=y(r,Symbol.toStringTag);if(!n){var o=d(r);n=y(o,Symbol.toStringTag)}p[e]=n.get}})),e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!s||!(Symbol.toStringTag in e)){var t=f(a(e),8,-1);return l(u,t)>-1}return!!y&&function(e){var t=!1;return n(p,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},155:e=>{var t,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var s,c=[],u=!1,l=-1;function f(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&p())}function p(){if(!u){var e=a(f);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function d(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new y(e,t)),1!==c.length||u||a(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=d,n.addListener=d,n.once=d,n.off=d,n.removeListener=d,n.removeAllListeners=d,n.emit=d,n.prependListener=d,n.prependOnceListener=d,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},422:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Database=void 0;const i=r(998),a=r(593);var s;!function(e){e[e.New=0]="New",e[e.V1=10]="V1",e[e.V2=20]="V2"}(s||(s={})),t.Database=class{constructor(e){this.db=(0,a.createDeferred)(),this.name=null!=e?e:"bf_sdk",this.init()}init(){return n(this,void 0,void 0,(function*(){const e=yield(0,i.openDB)(this.name,s.V2,{upgrade(e,t,r,i){var a,c,u,l;return n(this,void 0,void 0,(function*(){if(t===s.New&&(e.createObjectStore("devicekeys",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("issues",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("logs",{keyPath:"id",autoIncrement:!0}).createIndex("sessionUUID","sessionUUID"),e.createObjectStore("sessions",{keyPath:"uuid"})),t===s.V1){const e=i.objectStore("issues");try{for(var r,n=!0,f=o(e);r=yield f.next(),!(a=r.done);){l=r.value,n=!1;try{const e=l,t=Object.assign({},e.value);t.data.text=t.data.markdown,delete t.data.markdown,e.update(t)}finally{n=!0}}}catch(e){c={error:e}}finally{try{n||a||!(u=f.return)||(yield u.call(f))}finally{if(c)throw c.error}}}}))}});this.db.resolve(e)}))}get(){return this.db.promise}}},177:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryDeviceKeysTable=t.IDBDeviceKeysTable=void 0,t.IDBDeviceKeysTable=class{constructor(e){this.table=e}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteBatch(e){return this.table.deleteBatch(0,e)}getAll(){return this.table.getAll()}},t.InMemoryDeviceKeysTable=class{constructor(){this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteBatch(e){return r(this,void 0,void 0,(function*(){this.data.splice(0,e)}))}getAll(){return r(this,void 0,void 0,(function*(){return[...this.data]}))}}},941:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryIssuesTable=t.IDBIssuesTable=void 0,t.IDBIssuesTable=class{constructor(e){this.table=e}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteById(e){return this.table.deleteByIdx(e)}getBatch(e,t){return this.table.getBatch(e,t)}},t.InMemoryIssuesTable=class{constructor(){this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteById(e){return r(this,void 0,void 0,(function*(){const t=this.data.findIndex((t=>t.id===e));-1!==t&&this.data.splice(t,1)}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).slice(0,t)}))}}},856:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryLogsTable=t.IDBLogsTable=void 0,t.IDBLogsTable=class{constructor(e,t){this.table=e,this.logFactory=t}add(e){return this.table.add(e)}count(e){return this.table.countBy("sessionUUID",e)}deleteBatch(e,t){return this.table.deleteBatch(0,t,["sessionUUID",e])}deleteOldLogs(e,t=10){return r(this,void 0,void 0,(function*(){const r=yield this.table.getBatch(e,t);if(r.length<=1)return;const n={sessionUUID:e,data:this.logFactory.createGapLog(r.map((e=>e.data)))};yield Promise.all([this.table.patchByIdx(r[0].id,n),this.table.deleteBatch(1,t-1,["sessionUUID",e])])}))}getBatch(e,t){return this.table.getBatch(e,t)}},t.InMemoryLogsTable=class{constructor(e,t){this.logFactory=e,this.storageLimit=t,this.data=[],this.idCounter=0}getNextID(){return this.idCounter++}add(e){return r(this,void 0,void 0,(function*(){if(this.data.length>=this.storageLimit){const e=new Error("InMemory storage quota exceeded");throw e.name="QuotaExceededError",e}const t=this.getNextID();this.data.push(Object.assign(Object.assign({},e),{id:t}))}))}count(e){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).length}))}deleteBatch(e,t){return r(this,void 0,void 0,(function*(){const r=[];let n=0;for(let o=0;o<this.data.length;o++){const i=this.data[o];i.sessionUUID===e&&n<t?n++:r.push(i)}this.data=r}))}deleteOldLogs(e){return r(this,void 0,void 0,(function*(){const e=this.data.slice(0,10);e.length<=1||(this.data[0].data=this.logFactory.createGapLog(e.map((e=>e.data))),this.data.splice(1,9))}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){return this.data.filter((t=>t.sessionUUID===e)).slice(0,t)}))}}},967:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Table=void 0,t.Table=class{constructor(e,t){this.dbPromise=e,this.store=t}add(e){return r(this,void 0,void 0,(function*(){yield(yield this.dbPromise).add(this.store,e)}))}clear(){return r(this,void 0,void 0,(function*(){yield(yield this.dbPromise).clear(this.store)}))}countBy(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readonly");let n,o=0;if(e!==r.store.keyPath){const o=r.store.index(e),i=IDBKeyRange.only(t);n=yield o.openCursor(i)}else n=yield r.store.openCursor(IDBKeyRange.only(t));for(;n;)o++,n=yield n.continue();return o}))}deleteBatch(e,t,n){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readwrite");let o,i=0;if(n)if(n[0]!==r.store.keyPath){const e=r.store.index(n[0]),t=IDBKeyRange.only(n[1]);o=yield e.openCursor(t)}else o=yield r.store.openCursor(IDBKeyRange.only(n[1]));else o=yield r.store.openCursor();for(;o&&(i>=e&&o.delete(),i++,i!==e+t);)o=yield o.continue()}))}deleteByIdx(e){return r(this,void 0,void 0,(function*(){return(yield this.dbPromise).delete(this.store,e)}))}getAll(){return r(this,void 0,void 0,(function*(){return(yield this.dbPromise).getAll(this.store)}))}getBatch(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readonly").store.index("sessionUUID"),n=IDBKeyRange.only(e);let o=yield r.openCursor(n);const i=[];let a=0;for(;o&&(i.push(o.value),a++,a!==t);)o=yield o.continue();return i}))}patchByIdx(e,t){return r(this,void 0,void 0,(function*(){const r=(yield this.dbPromise).transaction(this.store,"readwrite"),n=yield r.store.get(e);yield r.store.put(Object.assign(Object.assign({},n),t))}))}}},572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogFactory=void 0;const n=r(431);t.LogFactory=class{constructor(e=32e3){this.maxLogLength=e}createFromDeviceKey(e,t,r,n){return this.createFromEntry({tag:"bf_key_value",text:`Set device data "${e}"="${t}"`},r,n)}createFromEntry(e,t,r){var o,i,a,s,c,u,l,f,p,y;let d=null!==(o=e.text)&&void 0!==o?o:"";return d.length>=this.maxLogLength&&(d=d.substring(0,this.maxLogLength)+"…"),{x:r.iso,t:d,m:null!==(a=null!==(i=e.method)&&void 0!==i?i:t.method)&&void 0!==a?a:"",at:r.epoch,tg:null!==(s=e.tag)&&void 0!==s?s:"",f:null!==(u=null!==(c=e.file)&&void 0!==c?c:t.file)&&void 0!==u?u:"",l:null!==(f=null!==(l=e.line)&&void 0!==l?l:t.line)&&void 0!==f?f:0,ll:null!==(p=e.level)&&void 0!==p?p:n.LogLevel.Debug,u:null!==(y=e.url)&&void 0!==y?y:""}}createFromIssue(e,t,r){return this.createFromEntry({level:n.LogLevel.Error,tag:"bf_issue",text:e},t,r)}createGapLog(e){const t=JSON.stringify({bf_start_date:e[0].at,bf_end_date:e[e.length-1].at});return{x:e[0].x,t,m:"",at:e[0].at,tg:"bf_gap_log",f:"",l:0,ll:0,u:e[0].u}}}},41:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageWriter=void 0,t.StorageWriter=class{constructor(e,t,r,n){this.deviceKeysTable=e,this.issuesTable=t,this.logFactory=r,this.logsTable=n,this.isClearingSpace=!1,this.logsQueue=[]}handleMessage(e){return r(this,void 0,void 0,(function*(){switch(e.type){case"device-key":return this.addDeviceKey(e.data.key,e.data.value,e.data.callInfo,e.data.time);case"init":this.options=e.data.options,this.sessionUUID=e.data.sessionUUID;break;case"issue":return this.addIssue(e.data.type,e.data.title,e.data.text,e.data.uuid,e.data.callInfo,e.data.time);case"log-entry":return this.addLogEntry(e.data.log,e.data.callInfo,e.data.time)}}))}addDeviceKey(e,t,r,n){this.deviceKeysTable.add({sessionUUID:this.sessionUUID,data:{key:e,value:t}}),this.addLog(this.logFactory.createFromDeviceKey(e,t,r,n))}addLog(e){return r(this,void 0,void 0,(function*(){const t={sessionUUID:this.sessionUUID,data:e};if(this.isClearingSpace)this.logsQueue.push(t);else try{yield this.logsTable.add(t)}catch(e){this.isQuotaExceededError(e)&&(this.logsQueue.push(t),this.isClearingSpace=!0,yield this.logsTable.deleteOldLogs(this.sessionUUID),yield this.processLogsQueue(),this.isClearingSpace=!1)}}))}addLogEntry(e,t,r){this.addLog(this.logFactory.createFromEntry(e,t,r))}addIssue(e,t,r,n,o,i){this.issuesTable.add({sessionUUID:this.sessionUUID,data:{title:t,text:r,type:e,uuid:n}}),this.addLog(this.logFactory.createFromIssue(n,o,i))}isQuotaExceededError(e){var t;return"QuotaExceededError"===e.name||"QuotaExceededError"===(null===(t=e.inner)||void 0===t?void 0:t.name)}processLogsQueue(){return r(this,void 0,void 0,(function*(){for(;this.logsQueue.length>0;){const e=this.logsQueue[0];try{yield this.logsTable.add(e),this.logsQueue.shift()}catch(e){this.isQuotaExceededError(e)&&(yield this.logsTable.deleteOldLogs(this.sessionUUID))}}}))}}},593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElByXPath=t.getXPath=t.DebounceByElement=t.UnreachableCaseError=t.CacheDecoratorFactory=t.createDeferred=void 0,t.createDeferred=function(){const e={isFulfilled:!1,isRejected:!1,isResolved:!1};return e.promise=new Promise(((t,r)=>{e.resolve=r=>{const n=e;n.isFulfilled=!0,n.isRejected=!1,n.isResolved=!0,n.value=r,t(r)},e.reject=t=>{const n=e;n.isFulfilled=!0,n.isRejected=!0,n.isResolved=!1,n.err=t,r(t)}})),e},t.CacheDecoratorFactory=function(e){return function(){return function(t,r,n){const o=n.value;n.value=function(){return e.has(r)||e.set(r,o.apply(this)),e.get(r)}}}};class r extends Error{constructor(e){super(`Unreachable case: ${JSON.stringify(e)}`)}}t.UnreachableCaseError=r,t.DebounceByElement=class{constructor(e){this.wait=e,this.timers=new Map}run(e,t){this.timers.has(e)&&clearTimeout(this.timers.get(e)),this.timers.set(e,setTimeout((()=>{t(),this.timers.delete(e)}),this.wait))}},t.getXPath=function(e){let t=e;if(t instanceof Element&&t.id)return\'//*[@id="\'+t.id+\'"]\';const r=[];for(;t&&t instanceof Element;){const e=t;let n=0,o=!1,i=e.previousSibling;for(;i;)i.nodeType!==Node.DOCUMENT_TYPE_NODE&&i.nodeName===e.nodeName&&n++,i=i.previousSibling;for(i=e.nextSibling;i;){if(i.nodeName===e.nodeName){o=!0;break}i=i.nextSibling}const a=e.prefix?e.prefix+":":"",s=n||o?`[${n+1}]`:"";r.push(a+e.localName+s),t=e.parentNode}return r.length?"/"+r.reverse().join("/"):""},t.getElByXPath=function(e){var t;return null!==(t=document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue)&&void 0!==t?t:void 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},955:(e,t,r)=>{"use strict";var n=r(584),o=r(662),i=r(430),a=r(692);function s(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,l=s(Object.prototype.toString),f=s(Number.prototype.valueOf),p=s(String.prototype.valueOf),y=s(Boolean.prototype.valueOf);if(c)var d=s(BigInt.prototype.valueOf);if(u)var h=s(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function b(e){return"[object Map]"===l(e)}function v(e){return"[object Set]"===l(e)}function m(e){return"[object WeakMap]"===l(e)}function w(e){return"[object WeakSet]"===l(e)}function O(e){return"[object ArrayBuffer]"===l(e)}function S(e){return"undefined"!=typeof ArrayBuffer&&(O.working?O(e):e instanceof ArrayBuffer)}function j(e){return"[object DataView]"===l(e)}function P(e){return"undefined"!=typeof DataView&&(j.working?j(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=o,t.isTypedArray=a,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||P(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},b.working="undefined"!=typeof Map&&b(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(b.working?b(e):e instanceof Map)},v.working="undefined"!=typeof Set&&v(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(v.working?v(e):e instanceof Set)},m.working="undefined"!=typeof WeakMap&&m(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(m.working?m(e):e instanceof WeakMap)},w.working="undefined"!=typeof WeakSet&&w(new WeakSet),t.isWeakSet=function(e){return w(e)},O.working="undefined"!=typeof ArrayBuffer&&O(new ArrayBuffer),t.isArrayBuffer=S,j.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&j(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=P;var A="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function I(e){return"[object SharedArrayBuffer]"===l(e)}function E(e){return void 0!==A&&(void 0===I.working&&(I.working=I(new A)),I.working?I(e):e instanceof A)}function D(e){return g(e,f)}function x(e){return g(e,p)}function U(e){return g(e,y)}function B(e){return c&&g(e,d)}function T(e){return u&&g(e,h)}t.isSharedArrayBuffer=E,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=D,t.isStringObject=x,t.isBooleanObject=U,t.isBigIntObject=B,t.isSymbolObject=T,t.isBoxedPrimitive=function(e){return D(e)||x(e)||U(e)||B(e)||T(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(S(e)||E(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},539:(e,t,r)=>{var n=r(155),o=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),s=n[r];r<o;s=n[++r])b(s)||!S(s)?a+=" "+s:a+=" "+u(s);return a},t.deprecate=function(e,r){if(void 0!==n&&!0===n.noDeprecation)return e;if(void 0===n)return function(){return t.deprecate(e,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),o=!0}return e.apply(this,arguments)}};var a={},s=/^$/;if(n.env.NODE_DEBUG){var c=n.env.NODE_DEBUG;c=c.replace(/[|\\\\{}()[\\]^$+?.]/g,"\\\\$&").replace(/\\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+c+"$","i")}function u(e,r){var n={seen:[],stylize:f};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&t._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),p(n,e,n.depth)}function l(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function f(e,t){return e}function p(e,r,n){if(e.customInspect&&r&&A(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return m(o)||(o=p(e,o,n)),o}var i=function(e,t){if(w(t))return e.stylize("undefined","undefined");if(m(t)){var r="\'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/\'/g,"\\\\\'").replace(/\\\\"/g,\'"\')+"\'";return e.stylize(r,"string")}return v(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):b(t)?e.stylize("null","null"):void 0}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),P(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return y(r);if(0===a.length){if(A(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(O(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(j(r))return e.stylize(Date.prototype.toString.call(r),"date");if(P(r))return y(r)}var u,l="",f=!1,S=["{","}"];return h(r)&&(f=!0,S=["[","]"]),A(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]"),O(r)&&(l=" "+RegExp.prototype.toString.call(r)),j(r)&&(l=" "+Date.prototype.toUTCString.call(r)),P(r)&&(l=" "+y(r)),0!==a.length||f&&0!=r.length?n<0?O(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=f?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)U(t,String(a))?i.push(d(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\\d+$/)||i.push(d(e,t,r,n,o,!0))})),i}(e,r,n,s,a):a.map((function(t){return d(e,r,n,s,t,f)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\\n"),e+t.replace(/\\u001b\\[\\d\\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\\n ")+" "+e.join(",\\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(u,l,S)):S[0]+l+S[1]}function y(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),U(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=b(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\\n")>-1&&(s=i?s.split("\\n").map((function(e){return"  "+e})).join("\\n").slice(2):"\\n"+s.split("\\n").map((function(e){return"   "+e})).join("\\n")):s=e.stylize("[Circular]","special")),w(a)){if(i&&o.match(/^\\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/\'/g,"\\\\\'").replace(/\\\\"/g,\'"\').replace(/(^"|"$)/g,"\'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function b(e){return null===e}function v(e){return"number"==typeof e}function m(e){return"string"==typeof e}function w(e){return void 0===e}function O(e){return S(e)&&"[object RegExp]"===I(e)}function S(e){return"object"==typeof e&&null!==e}function j(e){return S(e)&&"[object Date]"===I(e)}function P(e){return S(e)&&("[object Error]"===I(e)||e instanceof Error)}function A(e){return"function"==typeof e}function I(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!a[e])if(s.test(e)){var r=n.pid;a[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else a[e]=function(){};return a[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(955),t.isArray=h,t.isBoolean=g,t.isNull=b,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=w,t.isRegExp=O,t.types.isRegExp=O,t.isObject=S,t.isDate=j,t.types.isDate=j,t.isError=P,t.types.isNativeError=P,t.isFunction=A,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",x(),t.format.apply(t,arguments))},t.inherits=r(717),t._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var B="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function T(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError(\'The "original" argument must be of type Function\');if(B&&e[B]){var t;if("function"!=typeof(t=e[B]))throw new TypeError(\'The "util.promisify.custom" argument must be of type Function\');return Object.defineProperty(t,B,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),B&&Object.defineProperty(t,B,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,o(e))},t.promisify.custom=B,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError(\'The "original" argument must be of type Function\');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var o=t.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};e.apply(this,t).then((function(e){n.nextTick(a.bind(null,null,e))}),(function(e){n.nextTick(T.bind(null,e,a))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,o(e)),t}},430:(e,t,r)=>{"use strict";var n=r(804),o=r(83),i=r(924),a=i("Object.prototype.toString"),s=r(410)(),c="undefined"==typeof globalThis?r.g:globalThis,u=o(),l=i("String.prototype.slice"),f={},p=r(882),y=Object.getPrototypeOf;s&&p&&y&&n(u,(function(e){if("function"==typeof c[e]){var t=new c[e];if(Symbol.toStringTag in t){var r=y(t),n=p(r,Symbol.toStringTag);if(!n){var o=y(r);n=p(o,Symbol.toStringTag)}f[e]=n.get}}}));var d=r(692);e.exports=function(e){return!!d(e)&&(s&&Symbol.toStringTag in e?function(e){var t=!1;return n(f,(function(r,n){if(!t)try{var o=r.call(e);o===n&&(t=o)}catch(e){}})),t}(e):l(a(e),8,-1))}},83:(e,t,r)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],o="undefined"==typeof globalThis?r.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof o[n[t]]&&(e[e.length]=n[t]);return e}},882:(e,t,r)=>{"use strict";var n=r(210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},998:(e,t,r)=>{"use strict";r.r(t),r.d(t,{deleteDB:()=>b,openDB:()=>g,unwrap:()=>h,wrap:()=>d});const n=(e,t)=>t.some((t=>e instanceof t));let o,i;const a=new WeakMap,s=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let f={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return d(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){f=e(f)}function y(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(h(this),e),d(a.get(this))}:function(...e){return d(t.apply(h(this),e))}:function(e,...r){const n=t.call(h(this),e,...r);return c.set(n,e.sort?e.sort():[e]),d(n)}:(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));s.set(e,t)}(e),n(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,f):e);var t}function d(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(d(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&a.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=y(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const h=e=>l.get(e);function g(e,t,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(e,t),s=d(a);return n&&a.addEventListener("upgradeneeded",(e=>{n(d(a.result),e.oldVersion,e.newVersion,d(a.transaction),e)})),r&&a.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),s.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),s}function b(e,{blocked:t}={}){const r=indexedDB.deleteDatabase(e);return t&&r.addEventListener("blocked",(e=>t(e.oldVersion,e))),d(r).then((()=>{}))}const v=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],w=new Map;function O(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,o=m.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!v.includes(r))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),o&&i.done]))[0]};return w.set(t,i),i}p((e=>({...e,get:(t,r,n)=>O(t,r)||e.get(t,r,n),has:(t,r)=>!!O(t,r)||e.has(t,r)})));const S=["continue","continuePrimaryKey","advance"],j={},P=new WeakMap,A=new WeakMap,I={get(e,t){if(!S.includes(t))return e[t];let r=j[t];return r||(r=j[t]=function(...e){P.set(this,A.get(this)[t](...e))}),r}};async function*E(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,I);for(A.set(r,t),l.set(r,h(t));t;)yield r,t=await(P.get(r)||t.continue()),P.delete(r)}function D(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}p((e=>({...e,get:(t,r,n)=>D(t,r)?E:e.get(t,r,n),has:(t,r)=>D(t,r)||e.has(t,r)})))}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=r(422),t=r(967),n=r(572),o=r(177),i=r(941),a=r(856),s=r(41),c=new e.Database,u=new n.LogFactory,l=new o.IDBDeviceKeysTable(new t.Table(c.get(),"devicekeys")),f=new i.IDBIssuesTable(new t.Table(c.get(),"issues")),p=new a.IDBLogsTable(new t.Table(c.get(),"logs"),u),y=new s.StorageWriter(l,f,u,p);self.addEventListener("message",(e=>{y.handleMessage(e.data)}))})()})();\n',"Worker",void 0,void 0)}},477:e=>{"use strict";e.exports=function(e,t,r,n){var o=self||window;try{try{var i;try{i=new o.Blob([e])}catch(t){(i=new(o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder)).append(e),i=i.getBlob()}var s=o.URL||o.webkitURL,a=s.createObjectURL(i),c=new o[t](a,r);return s.revokeObjectURL(a),c}catch(n){return new o[t]("data:application/javascript,".concat(encodeURIComponent(e)),r)}}catch(e){if(!n)throw Error("Inline worker is not supported");return new o[t](n,r)}}},8698:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3083:(e,t,r)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],o="undefined"==typeof globalThis?r.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof o[n[t]]&&(e[e.length]=n[t]);return e}},882:(e,t,r)=>{"use strict";var n=r(210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},2998:(e,t,r)=>{"use strict";r.r(t),r.d(t,{deleteDB:()=>v,openDB:()=>g,unwrap:()=>h,wrap:()=>y});const n=(e,t)=>t.some((t=>e instanceof t));let o,i;const s=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return y(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){d=e(d)}function f(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(h(this),e),y(s.get(this))}:function(...e){return y(t.apply(h(this),e))}:function(e,...r){const n=t.call(h(this),e,...r);return c.set(n,e.sort?e.sort():[e]),y(n)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));a.set(e,t)}(e),n(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e);var t}function y(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(y(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=f(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const h=e=>l.get(e);function g(e,t,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=y(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(y(s.result),e.oldVersion,e.newVersion,y(s.transaction),e)})),r&&s.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function v(e,{blocked:t}={}){const r=indexedDB.deleteDatabase(e);return t&&r.addEventListener("blocked",(e=>t(e.oldVersion,e))),y(r).then((()=>{}))}const b=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],w=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,o=m.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!b.includes(r))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),o&&i.done]))[0]};return w.set(t,i),i}p((e=>({...e,get:(t,r,n)=>S(t,r)||e.get(t,r,n),has:(t,r)=>!!S(t,r)||e.has(t,r)})));const I=["continue","continuePrimaryKey","advance"],O={},P=new WeakMap,E=new WeakMap,D={get(e,t){if(!I.includes(t))return e[t];let r=O[t];return r||(r=O[t]=function(...e){P.set(this,E.get(this)[t](...e))}),r}};async function*j(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,D);for(E.set(r,t),l.set(r,h(t));t;)yield r,t=await(P.get(r)||t.continue()),P.delete(r)}function _(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}p((e=>({...e,get:(t,r,n)=>_(t,r)?j:e.get(t,r,n),has:(t,r)=>_(t,r)||e.has(t,r)})))}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(2853)})()));
//# sourceMappingURL=bugfender.js.map