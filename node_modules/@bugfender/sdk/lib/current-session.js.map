{"version":3,"file":"current-session.js","mappings":";CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAQ,kBAAoBD,IAE5BD,EAAK,kBAAoBC,GAC1B,CATD,CASGK,MAAM,IACT,uCCAA,IAAWC,EANAC,EAHXC,OAAOC,eAAeR,EAAS,aAAc,CAAES,OAAO,IACtDT,EAAQK,kBAAoBL,EAAQM,qBAAkB,GAE3CA,EAIUN,EAAQM,kBAAoBN,EAAQM,gBAAkB,CAAC,IAHjD,MAAI,YAC3BA,EAA4B,WAAI,iBAChCA,EAA4B,WAAI,kBAGzBD,EAGYL,EAAQK,oBAAsBL,EAAQK,kBAAoB,CAAC,IAF/C,YAAI,kBACnCA,EAA+B,YAAI,oBCXnCK,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAab,QAGrB,IAAIC,EAASS,EAAyBE,GAAY,CAGjDZ,QAAS,CAAC,GAOX,OAHAe,EAAoBH,GAAUX,EAAQA,EAAOD,QAASW,GAG/CV,EAAOD,OACf,8BCrBAO,OAAOC,eAAeR,EAAS,aAAc,CAAES,OAAO,IACtDT,EAAQgB,oBAAiB,EACzB,MAAMC,EAAiB,EAAQ,MA4C/BjB,EAAQgB,eA3CR,MACIE,YAAYC,EAAQC,EAAQC,EAAgBC,EAAeC,GACvDC,KAAKL,OAASA,EACdK,KAAKJ,OAASA,EACdI,KAAKH,eAAiBA,EACtBG,KAAKF,cAAgBA,EACrBE,KAAKD,YAAcA,EACnBC,KAAKC,OACT,CACAC,UACI,OAAOF,KAAKG,IAChB,CACAC,cACI,MAAMC,EAAaL,KAAKL,OAAOW,UAC/BN,KAAKJ,OAAOW,IAAI,gBAChBP,KAAKG,KAAOH,KAAKD,YAAYS,SAC7BR,KAAKH,eAAeY,QAAQhB,EAAeZ,kBAAkB6B,YAAaV,KAAKG,MAC/EH,KAAKH,eAAeY,QAAQhB,EAAeZ,kBAAkB8B,YAAaN,EAC9E,CACAJ,QACI,MAAME,EAAOH,KAAKH,eAAee,QAAQnB,EAAeZ,kBAAkB6B,aAC7D,OAATP,GACAH,KAAKJ,OAAOW,IAAI,yBAChBP,KAAKI,gBAGLJ,KAAKG,KAAOA,EACcH,KAAKH,eAAee,QAAQnB,EAAeZ,kBAAkB8B,eACpCX,KAAKL,OAAOW,WAE3DN,KAAKJ,OAAOW,IAAI,+BAChBP,KAAKI,eAGLJ,KAAKJ,OAAOW,IAAI,iBAAiBP,KAAKG,SAG9CH,KAAKF,cAAce,aAAa,CAC5BV,KAAMH,KAAKG,KACXW,KAAMd,KAAKL,OAAOW,WAE1B,UHnCJ","sources":["webpack://@bugfender/sdk/webpack/universalModuleDefinition","webpack://@bugfender/sdk/./src/storage-keys.ts","webpack://@bugfender/sdk/webpack/bootstrap","webpack://@bugfender/sdk/./src/current-session.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@bugfender/sdk\"] = factory();\n\telse\n\t\troot[\"@bugfender/sdk\"] = factory();\n})(self, () => {\nreturn ","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SessionStorageKey = exports.LocalStorageKey = void 0;\nvar LocalStorageKey;\n(function (LocalStorageKey) {\n    LocalStorageKey[\"AppID\"] = \"bf_app_id\";\n    LocalStorageKey[\"DeviceData\"] = \"bf_device_data\";\n    LocalStorageKey[\"DeviceUDID\"] = \"bf_device_udid\";\n})(LocalStorageKey = exports.LocalStorageKey || (exports.LocalStorageKey = {}));\nvar SessionStorageKey;\n(function (SessionStorageKey) {\n    SessionStorageKey[\"SessionUDID\"] = \"bf_session_udid\";\n    SessionStorageKey[\"SessionUUID\"] = \"bf_session_uuid\";\n})(SessionStorageKey = exports.SessionStorageKey || (exports.SessionStorageKey = {}));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CurrentSession = void 0;\nconst storage_keys_1 = require(\"./storage-keys\");\nclass CurrentSession {\n    constructor(device, logger, sessionStorage, sessionsTable, uuidFactory) {\n        this.device = device;\n        this.logger = logger;\n        this.sessionStorage = sessionStorage;\n        this.sessionsTable = sessionsTable;\n        this.uuidFactory = uuidFactory;\n        this.reset();\n    }\n    getUUID() {\n        return this.uuid;\n    }\n    initSession() {\n        const deviceUDID = this.device.getUDID();\n        this.logger.log('Init session');\n        this.uuid = this.uuidFactory.create();\n        this.sessionStorage.setItem(storage_keys_1.SessionStorageKey.SessionUUID, this.uuid);\n        this.sessionStorage.setItem(storage_keys_1.SessionStorageKey.SessionUDID, deviceUDID);\n    }\n    reset() {\n        const uuid = this.sessionStorage.getItem(storage_keys_1.SessionStorageKey.SessionUUID);\n        if (uuid === null) {\n            this.logger.log('Session not available');\n            this.initSession();\n        }\n        else {\n            this.uuid = uuid;\n            const sessionDeviceUDID = this.sessionStorage.getItem(storage_keys_1.SessionStorageKey.SessionUDID);\n            const hasDeviceUDIDChanged = sessionDeviceUDID !== this.device.getUDID();\n            if (hasDeviceUDIDChanged) {\n                this.logger.log('Session Device UDID changed');\n                this.initSession();\n            }\n            else {\n                this.logger.log(`Session UUID: ${this.uuid}`);\n            }\n        }\n        this.sessionsTable.addIfMissing({\n            uuid: this.uuid,\n            udid: this.device.getUDID(),\n        });\n    }\n}\nexports.CurrentSession = CurrentSession;\n"],"names":["root","factory","exports","module","define","amd","self","SessionStorageKey","LocalStorageKey","Object","defineProperty","value","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","CurrentSession","storage_keys_1","constructor","device","logger","sessionStorage","sessionsTable","uuidFactory","this","reset","getUUID","uuid","initSession","deviceUDID","getUDID","log","create","setItem","SessionUUID","SessionUDID","getItem","addIfMissing","udid"],"sourceRoot":""}