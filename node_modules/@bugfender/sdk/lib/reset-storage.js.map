{"version":3,"file":"reset-storage.js","mappings":"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","sources":["webpack://@bugfender/sdk/webpack/universalModuleDefinition","webpack://@bugfender/sdk/./src/reset-storage.ts","webpack://@bugfender/sdk/./src/storage-keys.ts","webpack://@bugfender/sdk/webpack/bootstrap","webpack://@bugfender/sdk/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@bugfender/sdk\"] = factory();\n\telse\n\t\troot[\"@bugfender/sdk\"] = factory();\n})(self, () => {\nreturn ","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResetStorage = void 0;\nconst storage_keys_1 = require(\"./storage-keys\");\nclass ResetStorage {\n    constructor(apiFeatures, session, database, localStorage, sessionStorage) {\n        this.apiFeatures = apiFeatures;\n        this.session = session;\n        this.database = database;\n        this.localStorage = localStorage;\n        this.sessionStorage = sessionStorage;\n    }\n    resetIfAppChanged(appID) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cachedAppID = this.localStorage.getItem(storage_keys_1.LocalStorageKey.AppID);\n            if (cachedAppID !== null && cachedAppID !== appID) {\n                const localStorageKeys = [storage_keys_1.LocalStorageKey.AppID, storage_keys_1.LocalStorageKey.DeviceData, storage_keys_1.LocalStorageKey.DeviceUDID];\n                const sessionStorageKeys = [storage_keys_1.SessionStorageKey.SessionUDID, storage_keys_1.SessionStorageKey.SessionUUID];\n                localStorageKeys.forEach(key => this.localStorage.removeItem(key));\n                sessionStorageKeys.forEach(key => this.sessionStorage.removeItem(key));\n                this.session.reset();\n                if (yield this.apiFeatures.isIndexedDBSupported()) {\n                    const db = yield this.database.get();\n                    yield Promise.all([\n                        db.clear('devicekeys'),\n                        db.clear('issues'),\n                        db.clear('logs'),\n                        db.clear('sessions'),\n                    ]);\n                }\n            }\n            this.localStorage.setItem(storage_keys_1.LocalStorageKey.AppID, appID);\n        });\n    }\n}\nexports.ResetStorage = ResetStorage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SessionStorageKey = exports.LocalStorageKey = void 0;\nvar LocalStorageKey;\n(function (LocalStorageKey) {\n    LocalStorageKey[\"AppID\"] = \"bf_app_id\";\n    LocalStorageKey[\"DeviceData\"] = \"bf_device_data\";\n    LocalStorageKey[\"DeviceUDID\"] = \"bf_device_udid\";\n})(LocalStorageKey = exports.LocalStorageKey || (exports.LocalStorageKey = {}));\nvar SessionStorageKey;\n(function (SessionStorageKey) {\n    SessionStorageKey[\"SessionUDID\"] = \"bf_session_udid\";\n    SessionStorageKey[\"SessionUUID\"] = \"bf_session_uuid\";\n})(SessionStorageKey = exports.SessionStorageKey || (exports.SessionStorageKey = {}));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(6105);\n"],"names":["root","factory","exports","module","define","amd","self","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","ResetStorage","storage_keys_1","constructor","apiFeatures","session","database","localStorage","sessionStorage","resetIfAppChanged","appID","cachedAppID","getItem","LocalStorageKey","AppID","localStorageKeys","DeviceData","DeviceUDID","sessionStorageKeys","SessionStorageKey","SessionUDID","SessionUUID","forEach","key","removeItem","reset","isIndexedDBSupported","db","get","all","clear","setItem","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}